
﻿
var CONST_CLASS_CARREGANDOCONTEUDO="CarregandoConteudo";var CONST_CLASS_CONTEUDOCARREGADO="ConteudoCarregado";var CONST_CLASS_CAMPOSPREENCHIDOS="CamposPreenchidos";var CONST_CLASS_ITEM_SELECIONADO="Selecionada";var CONST_CLASS_ITEM_EXPANDIDO="Expandida";var CONST_CLASS_TEMPLATE="Template";var CONST_CLASS_ITEM_ITEMDINAMICO="ItemDinamico";var CONST_CLASS_PICKERDEDATA="Picker_Data";var CONST_SISTEMA_CLIENTES="Clientes";var CONST_SISTEMA_RISCO="Risco";var CONST_SISTEMA_PAPEIS="Papeis";var CONST_SISTEMA_SEGURANCA="Seguranca";var CONST_SISTEMA_MONITORAMENTO="Monitoramento";var CONST_SISTEMA_SISTEMA="Sistema";var CONST_SUBSISTEMA_BUSCA="Busca";var CONST_SUBSISTEMA_NOVO_PF="Novo_PF";var CONST_SUBSISTEMA_NOVO_PJ="Novo_PJ";var CONST_SUBSISTEMA_MIGRACAO="Migracao";var CONST_SUBSISTEMA_SINCRONIZACAO="Sincronizacao";var CONST_SUBSISTEMA_NOVO_USUARIO="Novo_Usuario";var CONST_SUBSISTEMA_NOVO_GRUPO="Novo_Grupo";var CONST_SUBSISTEMA_NOVO_PERFIL="Novo_Perfil";var CONST_SUBSISTEMA_NOVO_PAPEL="Novo_Papel";var CONST_SUBSISTEMA_RELATORIOS="Relatorios";var CONST_SUBSISTEMA_USUARIOSLOGADOS="UsuariosLogados";var CONST_SUBSISTEMA_ORDENS="Ordens";var CONST_SUBSISTEMA_OBJETOS="ObjetosDoSistema";var CONST_SUBSISTEMA_VARIAVEIS="VariaveisDoSistema";var CONST_SUBSISTEMA_NOVO_PERFILDERISCO="Novo_PerfilDeRisco";var CONST_SUBSISTEMA_PESSOASVINCULADAS="PessoasVinculadas";var CONST_SEGURANCA_TIPODEOBJETO_USUARIO="Usuario";var CONST_SEGURANCA_TIPODEOBJETO_GRUPO="Grupo";var CONST_SEGURANCA_TIPODEOBJETO_PERFIL="Perfil";var CONST_SUITABILITY_RESULTADO_0="CadastroNaoFinalizado";var CONST_SUITABILITY_RESULTADO_1="BaixoRisco";var CONST_SUITABILITY_RESULTADO_2="MedioRiscoSemRendaVariavel";var CONST_SUITABILITY_RESULTADO_3="MedioRiscoComRendaVariavel";var CONST_SUITABILITY_RESULTADO_4="Arrojado";var gGradIntra_Config_DelayDeRequest=200;var gGradIntra_Config_DuracaoDaAnimacaoDeMensagem=500;var gGradIntra_MensagemOriginal=null;var gGradIntra_MensagemOriginalTimeout=4000;var gGradIntra_RedirecionarParaLoginEm=0;var gGradIntra_MensagemRedirecionamentoLogin="Sua sessão expirou. você será <a href='[URL]'>redirecionado para o login</a> em [SEG] segundos";function GradIntra_ExibirMensagem(pTipo_IAE,pMensagem,pRetornarAoEstadoNormalAposSegundos,pMensagemAdicional)
{if(gGradIntra_MensagemOriginal==null)
gGradIntra_MensagemOriginal=$("#pnlMensagem span").html();var lMultiplicador=6.5;if(pMensagem.indexOf("</")!=-1)
lMultiplicador=3.5;var lAmarelo="#e9f68b";var lAzul="#78ccd2";var lVemelho="#d47d7d";var lOriginal="#9BA2AC";var lClasse="";var lCor=(pTipo_IAE=="A")?lAmarelo:((pTipo_IAE=="I")?lAzul:((pTipo_IAE=="E")?lVemelho:lOriginal));var lLargura=Math.ceil((pMensagem.length*lMultiplicador));if(lCor==lOriginal)
{if(lLargura<142)lLargura=142;}
else
{if(pTipo_IAE=="E")
{if(lLargura<400)lLargura=400;}
else
{if(lLargura<342)lLargura=342;}}
if(lCor==lVemelho)
lClasse="ForeClara";$("#pnlMensagem").animate({backgroundColor:lCor,width:lLargura},gGradIntra_Config_DuracaoDaAnimacaoDeMensagem,function()
{GradIntra_ExibirMensagemAdicional(pMensagemAdicional);}).children("span").html(pMensagem).attr("class",lClasse);if(pRetornarAoEstadoNormalAposSegundos==true)
{window.setTimeout(GradIntra_RetornarMensagemAoEstadoNormal,4000);}}
function GradIntra_ExibirMensagemAdicional(pMensagem)
{if(pMensagem&&pMensagem!="")
{var lPainel=$("#pnlMensagemAdicional");if(lPainel.is(":visible"))
{lPainel.children("textarea").html(pMensagem);}
else
{var lLargura=$("#pnlMensagem").width();lPainel.css({width:lLargura}).effect("blind",{mode:"show",easing:"easeOutBounce"},(gGradIntra_Config_DuracaoDaAnimacaoDeMensagem*2)).children("textarea").html(pMensagem)}}}
function GradIntra_OcultarMensagemAdicional()
{$("#pnlMensagemAdicional").effect("blind",{mode:"hide",easing:"easeInOutExpo"},(gGradIntra_Config_DuracaoDaAnimacaoDeMensagem));return false;}
function GradIntra_RetornarMensagemAoEstadoNormal()
{if($("#pnlMensagemAdicional").is(":visible"))
{GradIntra_OcultarMensagemAdicional();window.setTimeout(GradIntra_RetornarMensagemAoEstadoNormal,(gGradIntra_Config_DuracaoDaAnimacaoDeMensagem+50));}
else
{GradIntra_ExibirMensagem("O",gGradIntra_MensagemOriginal);}}
function GradIntra_InstanciarObjetoDosControles(pObjetoSeletor)
{var lRetorno=new Object();var lCampo,lPropriedade,lValor;var lTREditando=pObjetoSeletor.parent().find("table.Lista tr.Editando");var lAspas=true;pObjetoSeletor.find("[Propriedade]").each(function()
{lCampo=$(this);lAspas=true;lPropriedade=lCampo.attr("Propriedade");lValor=lCampo.val();if(lCampo.is("[type='checkbox']"))
{lValor=lCampo.attr("checked");lAspas=false;}
if(lCampo.is("[type='radio']"))
{lValor=lCampo.attr("checked");lAspas=false;}
eval("lRetorno."+lPropriedade+" = "+(lAspas?"'":"")+lValor+(lAspas?"'":"")+";");if(lCampo.is("select"))
eval("lRetorno."+lPropriedade+"Desc = '"+lCampo.children("option:selected").html()+"';");});if((!lRetorno.Id||lRetorno.Id=="")&&lTREditando.length==0)
lRetorno.Estado="Novo"
else
lRetorno.Estado="Modificado"
return lRetorno;}
function GradIntra_ExibirObjetoNaLista(pObjeto,pDivFormulario)
{var lTBody=pDivFormulario.parent().find("table.Lista tbody");if(pObjeto.TipoDeItem)
{GradIntra_ConfigurarResumo(pObjeto,pObjeto.TipoDeItem);}
else
{if(gGradIntra_Cadastro_ItemFilhoSendoEditado!=null)
if(gGradIntra_Cadastro_ItemFilhoSendoEditado.TipoDeItem&&gGradIntra_Cadastro_ItemFilhoSendoEditado.TipoDeItem!="")
GradIntra_ConfigurarResumo(pObjeto,gGradIntra_Cadastro_ItemFilhoSendoEditado.TipoDeItem);}
var lTR;var lItemNovo=false;lTR=lTBody.find("tr[rel='"+pObjeto.Id+"']");if(lTR.length==0)
{lTR=lTBody.find("tr.Template").clone();lTR.addClass("ItemDinamico");lItemNovo=true;}
var lPropriedade,lValor;lTR.attr("rel",pObjeto.Id).removeClass(CONST_CLASS_TEMPLATE).removeClass("Editando").find("td input[Propriedade='json']").val($.toJSON(pObjeto));lTR.children("TD").each(function()
{lPropriedade=$(this).attr("Propriedade");if(lPropriedade&&lPropriedade!="")
{lValor=eval("pObjeto."+lPropriedade);$(this).html(lValor);}});if(lItemNovo)
{lTBody.children("tr:eq(0)").after(lTR);lTR.show();lTBody.find("tr.Nenhuma").hide();var lThead=lTBody.parent().find("thead");if(lThead.hasClass("ExibirSeTiverItem"))
lThead.show();}
else
{}}
function GradIntra_ExibirObjetoNoFormulario(pObjeto,pDivFormulario)
{var lCampo,lPropriedade,lValor;pDivFormulario.find("[Propriedade]").each(function()
{lCampo=$(this);lPropriedade=lCampo.attr("Propriedade");lValor=eval("pObjeto."+lPropriedade+";");if(lCampo.is("[type='checkbox']"))
{var lCheckId=lCampo.attr("id");if(lValor==true)
{lCampo.attr("checked","checked");lCampo.parent().find("label[for='"+lCheckId+"']").addClass("checked");}
else
{lCampo.attr("checked",null);lCampo.parent().find("label[for='"+lCheckId+"']").removeClass("checked");}}
else if(lCampo.is("input, select"))
{lCampo.val(lValor);if(lCampo.is("[type='radio']"))
{var lRadioName=lCampo.attr("name");var lRadioSim=lRadioName+"_Sim";var lRadioNao=lRadioName+"_Nao";if(lValor==true)
{$("#"+lRadioSim).attr("checked","checked").parent().find("label[for='"+lRadioSim+"']").addClass("checked");$("#"+lRadioNao).attr("checked",null).parent().find("label[for='"+lRadioNao+"']").removeClass("checked");}
else
{$("#"+lRadioSim).attr("checked",null).parent().find("label[for='"+lRadioSim+"']").removeClass("checked");$("#"+lRadioNao).attr("checked","checked").parent().find("label[for='"+lRadioNao+"']").addClass("checked");}}}
else
{lCampo.html(lValor);}});pDivFormulario.show();}
function GradIntra_CarregarHtmlVerificandoErro(pUrl,pDadosDoRequest,pPainelParaAtualizar,pCallBack,pOpcoesPosCarregamento)
{$.ajax({url:pUrl,type:"post",cache:false,data:pDadosDoRequest,success:function(pResposta){GradIntra_CarregarVerificandoErro_CallBack(pResposta,pPainelParaAtualizar,pCallBack,pOpcoesPosCarregamento);},error:GradIntra_TratarRespostaComErro});}
function GradIntra_CarregarJsonVerificandoErro(pUrl,pDadosDoRequest,pCallBackDeSucesso,pOpcoesPosCarregamento)
{$.ajax({url:pUrl,type:"post",cache:false,dataType:"json",data:pDadosDoRequest,success:function(pResposta){GradIntra_CarregarVerificandoErro_CallBack(pResposta,null,pCallBackDeSucesso,null);},error:GradIntra_TratarRespostaComErro});}
function GradIntra_CarregarVerificandoErro_CallBack(pResposta,pPainelParaAtualizar,pCallBack,pOpcoesPosCarregamento)
{if(pResposta.Mensagem)
{if(pResposta.TemErro)
{GradIntra_TratarRespostaComErro(pResposta);}
else
{if(pCallBack&&pCallBack!=null)
pCallBack(pResposta,pPainelParaAtualizar,pOpcoesPosCarregamento);}}
else
{if(pResposta.indexOf('"TemErro":true,')!=-1)
{GradIntra_TratarRespostaComErro($.evalJSON(pResposta));}
else
{if(pResposta.indexOf('<fieldset id="pnlLogin">')!=-1)
{GradIntra_TratarRespostaComErro({TemErro:true,Mensagem:"RESPOSTA_SESSAO_EXPIRADA"});}
else
{if(pPainelParaAtualizar!=null)
{if(!pPainelParaAtualizar.attr)
{if(pPainelParaAtualizar.charAt(0)!="#")pPainelParaAtualizar="#"+pPainelParaAtualizar;pPainelParaAtualizar=$(pPainelParaAtualizar);}
pPainelParaAtualizar.html(pResposta).addClass("ConteudoCarregado");if(pOpcoesPosCarregamento)
{if(pOpcoesPosCarregamento.CustomInputs)
{$(pOpcoesPosCarregamento.CustomInputs).each(function()
{$(this+"").customInput();});}
if(pOpcoesPosCarregamento.HabilitarMascaras)
{HabilitarMascaraNumerica(pPainelParaAtualizar.find("input.Mascara_Data"),"99/99/9999");HabilitarMascaraNumerica(pPainelParaAtualizar.find("input.Mascara_CEP"),"99999-999");HabilitarMascaraNumerica(pPainelParaAtualizar.find("input.Mascara_TEL"),"9999-9999");HabilitarMascaraNumerica(pPainelParaAtualizar.find("input.Mascara_CPF"),"999.999.999-99");pPainelParaAtualizar.find("input.Mascara_Hora").mask("99:99");}
if(pOpcoesPosCarregamento.HabilitarValidacoes)
{pPainelParaAtualizar.validationEngine({showTriangle:false});}
if(pOpcoesPosCarregamento.AtivarToolTips)
{GradIntra_AtivarTooltips(pPainelParaAtualizar);}
pPainelParaAtualizar.find("input.Mascara_CNPJ").mask("99.999.999/9999-99");pPainelParaAtualizar.find("input.proibirLetras").bind("keydown",function(event){Validacao_SomenteNumeros_OnKeyDown(event)});}
pPainelParaAtualizar.find("."+CONST_CLASS_PICKERDEDATA).datepicker({showOn:"button"});$(".ui-datepicker").hide();}
if(pCallBack&&pCallBack!=null)
pCallBack(pResposta,pPainelParaAtualizar,pOpcoesPosCarregamento);}}}}
function HabilitarMascaraNumerica(pCampos,pMascara)
{pCampos.bind("keydown",ProibirNaoNumericos).mask(pMascara);}
function ProibirNaoNumericos(evt)
{evt=(evt)?evt:window.event
var charCode=(evt.which)?evt.which:evt.keyCode
if(charCode>31&&(charCode<48||charCode>57))
return false
return true}
function GradIntra_ConfigurarResumo(pObjeto,pTipo)
{pObjeto.Resumo=function(){return"Resumo não configurado para tipo '"+pTipo+"'";}
if(pTipo=="Telefone")
{pObjeto.Resumo=function()
{var lRetorno="";lRetorno+="("+this.DDD+") ";lRetorno+=this.Numero;if(this.Ramal&&this.Ramal!=0&&this.Ramal!=null&&this.Ramal!="")
{lRetorno+=" r."+this.Ramal;}
if(this.Tipo=="R")
lRetorno+=" (res)";if(this.Tipo=="M")
lRetorno+=" (com)";if(this.Tipo=="C")
lRetorno+=" (cel)";return lRetorno;};}
if(pTipo=="Procurador"||pTipo=="Diretor"||pTipo=="Representante")
{pObjeto.Resumo=function()
{var lRetorno="";lRetorno+=this.Nome+" - ";lRetorno+=this.CPF;return lRetorno;};}
if(pTipo=="Emitente")
{pObjeto.Resumo=function()
{var lRetorno="";lRetorno+=this.Nome+", ";lRetorno+=this.CodigoSistema+" - ";lRetorno+=this.CPFCNPJ;return lRetorno;};}
if(pTipo=="Endereco")
{pObjeto.Resumo=function()
{var lRetorno="";lRetorno+=this.Logradouro+", ";lRetorno+=this.Numero+" - ";lRetorno+=this.Bairro+" - ";lRetorno+="CEP "+this.CEP;return lRetorno;};}
if(pTipo=="PendenciaCadastral")
{pObjeto.Resumo=function()
{var lRetorno="";lRetorno+=this.DataPendencia+" - ";lRetorno+=this.Descricao+" - ";lRetorno+=(this.FlagResolvido)?"Resolvido":"Pendente";return lRetorno;};}
if(pTipo=="Conta")
{pObjeto.Resumo=function()
{var lRetorno="";lRetorno+=this.Banco+" ";lRetorno+="Ag. "+this.Agencia+" ";lRetorno+="("+this.TipoConta+") ";lRetorno+=this.ContaCorrente+" - "+this.DigitoConta;return lRetorno;}}
if(pTipo=="PessoaFisica")
{pObjeto.Resumo=function()
{var lRetorno="";lRetorno+=this.Nome+", ";lRetorno+="CPF "+this.CPF;return lRetorno;}}
if(pTipo=="EmpresaColigada"){pObjeto.Resumo=function(){var lRetorno="";lRetorno+=this.RazaoSocial+", ";lRetorno+="CNPJ "+this.CNPJ;return lRetorno;}}
if(pTipo=="RepresentanteParaNaoResidente")
{pObjeto.Resumo=function()
{var lRetorno="";lRetorno+=this.Nome+" - ";lRetorno+="["+this.CodigoCVM+"]";return lRetorno;}}
if(pTipo=="Grupos"||pTipo=="Usuarios"||pTipo=="Perfis"){pObjeto.Resumo=function(){var lRetorno="";lRetorno+=this.ItemDesc+" - ";lRetorno+="["+this.Item+"]";return lRetorno;}}
if(pTipo=="Permissoes")
{pObjeto.Resumo=function(){var lRetorno="";lRetorno+=this.PermissaoDesc+" - ";lRetorno+="["+this.RestricaoDesc+"]";return lRetorno;}}
if(pTipo=="Regra")
{pObjeto.Resumo=function(){var lRetorno="";lRetorno+=this.Ativo+" - ";lRetorno+=this.IdBolsaDesc+" - ";lRetorno+=this.IdRegraDesc;return lRetorno;}}}
function GradIntra_TratarRespostaComErro(pResposta)
{$("."+CONST_CLASS_CARREGANDOCONTEUDO).removeClass(CONST_CLASS_CARREGANDOCONTEUDO);if(pResposta.status&&pResposta.status!=200)
{var lTexto=pResposta.responseText;lTexto=lTexto.replace(/</gi,"&lt;");lTexto=lTexto.replace(/>/gi,"&gt;");GradIntra_ExibirMensagem("E","Erro do servidor ["+pResposta.status+" - "+pResposta.statusText+"]                                       ",false,lTexto);}
else
{if(pResposta.TemErro)
{if(pResposta.Mensagem=="RESPOSTA_SESSAO_EXPIRADA")
{GradIntra_ExibirMensagem("E",GradIntra_MensagemDeRedirecionamento(5));gGradIntra_RedirecionarParaLoginEm=4;window.setTimeout(GradIntra_TimeoutParaRedirecionarLogin,1000);}
else
{GradIntra_ExibirMensagem("E",pResposta.Mensagem,false,pResposta.MensagemExtendida);}}
else
{var lMensagemExtendida="";try
{lMensagemExtendida+=$.toJSON(pResposta)+"\r\n\r\n";}
catch(pErro1){}
try
{lMensagemExtendida+=pResposta+"\r\n\r\n";}
catch(pErro2){}
try
{if(pResposta.responseText)
{var lTexto=pResposta.responseText;lTexto=lTexto.replace("<","&lt;","gi");lTexto=lTexto.replace(">","&gt;","gi");lMensagemExtendida+=lTexto;}}
catch(pErro3){}
GradIntra_ExibirMensagem("E","Erro desconhecido                                       ",false,lMensagemExtendida);}}}
function GradIntra_TimeoutParaRedirecionarLogin()
{if(gGradIntra_RedirecionarParaLoginEm>=0)
{$("#pnlMensagem span").html(GradIntra_MensagemDeRedirecionamento(gGradIntra_RedirecionarParaLoginEm));gGradIntra_RedirecionarParaLoginEm--;window.setTimeout(GradIntra_TimeoutParaRedirecionarLogin,1000);}
else
{document.location=GradIntra_RaizDoSite()+"/Login.aspx";}}
function GradIntra_RaizDoSite()
{var lRetorno=document.location.protocol+"//"+document.location.host;if(document.location.host=="localhost")
lRetorno+="/Gradual.Intranet";return lRetorno;}
function GradIntra_MensagemDeRedirecionamento(pSegundos)
{return gGradIntra_MensagemRedirecionamentoLogin.replace("[SEG]",pSegundos).replace("[URL]",GradIntra_RaizDoSite()+"/Login.aspx");}
function GradIntra_AtivarTooltips(pSeletor)
{var lObjetosParaAtivar;if(!pSeletor||pSeletor==null||pSeletor=="")
{pSeletor="";}
if(pSeletor.find)
{lObjetosParaAtivar=pSeletor.find("[title]");}
else
{if(pSeletor!="")pSeletor+=" ";lObjetosParaAtivar=$(pSeletor+"[title]");}
lObjetosParaAtivar.bt({shrinkToFit:true,padding:'4px',spikeGirth:8,spikeLength:8,positions:["right","left","most"],fill:"rgb(242, 247, 204)",strokeWidth:2,strokeStyle:"rgb(152, 156, 162)",centerPointX:0.5,centerPointY:0.5,cssClass:"bt-tooltip-arrow",cornerRadius:3,cssStyles:{color:"#506377",fontSize:"0.8em",padding:"2px 6px 2px 6px"}});}
function isNumeric(sText)
{var ValidChars="0123456789";var IsNumber=true;var Char;for(i=0;i<sText.length&&IsNumber==true;i++)
{Char=sText.charAt(i);if(ValidChars.indexOf(Char)==-1)
{IsNumber=false;}}
return IsNumber;}
function AbrirLinkPDF(sCaminhoVirtualPDF)
{window.open(sCaminhoVirtualPDF);return false;}
﻿
var gGradIntra_Navegacao_SistemaAtual=null;var gGradIntra_Navegacao_SubSistemaAtual=null;var gGradIntra_Navegacao_PainelDeBuscaAtual=null;var gGradIntra_Navegacao_PainelDeConteudoAtual=null;function GradIntra_Navegacao_IrParaSistema(pSistema,pNavegarAutomaticamenteParaSubSistema)
{if(pSistema!=""&&pSistema!=null&&pSistema!=gGradIntra_Navegacao_SistemaAtual)
{var lLI,lLink;gGradIntra_Navegacao_SistemaAtual=pSistema;gGradIntra_Navegacao_SubSistemaAtual=null;gGradIntra_Navegacao_PainelDeBuscaAtual=$("#pnlBusca_"+gGradIntra_Navegacao_SistemaAtual);gGradIntra_Navegacao_PainelDeConteudoAtual=$("#pnlConteudo_"+gGradIntra_Navegacao_SistemaAtual);$("#pnlMenuPrincipal > li").removeClass(CONST_CLASS_ITEM_SELECIONADO);$("#pnlConteudo > div").hide();lLI=$("#pnlMenuPrincipal > li a[rel='"+gGradIntra_Navegacao_SistemaAtual+"']").parent();lLI.addClass(CONST_CLASS_ITEM_SELECIONADO);lLink=lLI.find("ul.SubMenu li."+CONST_CLASS_ITEM_SELECIONADO+" a");if(lLink.length==0)
{lLink=lLI.find("ul.SubMenu li a[rel]:eq(0)");}
if(pNavegarAutomaticamenteParaSubSistema)
GradIntra_Navegacao_IrParaSubSistema(pSistema,lLink.attr("rel"));}}
function GradIntra_Navegacao_IrParaSubSistema(pSistema,pSubSistema)
{if(pSistema!=gGradIntra_Navegacao_SistemaAtual)
{GradIntra_Navegacao_IrParaSistema(pSistema,false);}
if(pSubSistema!=""&&pSubSistema!=null&&pSubSistema!=gGradIntra_Navegacao_SubSistemaAtual)
{var lExibirBusca=true;var lFlagRecarregarPorMigracao=false;lFlagRecarregarPorMigracao=((gGradIntra_Navegacao_SubSistemaAtual==CONST_SUBSISTEMA_MIGRACAO)||(pSubSistema==CONST_SUBSISTEMA_MIGRACAO));gGradIntra_Navegacao_SubSistemaAtual=pSubSistema;$("ul.Sistema_"+gGradIntra_Navegacao_SistemaAtual+" li").removeClass(CONST_CLASS_ITEM_SELECIONADO);$("ul.Sistema_"+gGradIntra_Navegacao_SistemaAtual+" li a[rel='"+gGradIntra_Navegacao_SubSistemaAtual+"']").parent().addClass(CONST_CLASS_ITEM_SELECIONADO);gGradIntra_Navegacao_PainelDeConteudoAtual.children("ul").hide();gGradIntra_Navegacao_PainelDeConteudoAtual.children("div").hide();if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_MONITORAMENTO||lFlagRecarregarPorMigracao)
{$("#pnlBusca_"+gGradIntra_Navegacao_SistemaAtual).removeClass(CONST_CLASS_CONTEUDOCARREGADO);$("#pnlConteudo_"+gGradIntra_Navegacao_SistemaAtual).removeClass(CONST_CLASS_CONTEUDOCARREGADO).hide();}
if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_SISTEMA)
{if(pSubSistema==CONST_SUBSISTEMA_VARIAVEIS||pSubSistema==CONST_SUBSISTEMA_PESSOASVINCULADAS)
{$("#pnlBusca_Sistema").hide();lExibirBusca=false;}}
if(pSubSistema==CONST_SUBSISTEMA_RELATORIOS)
{GradIntra_Navegacao_ExibirFiltroDeRelatorio();}
else
{if(lExibirBusca)
GradIntra_Navegacao_ExibirBusca();}
GradIntra_Navegacao_ExibirConteudo();Preferencias_SalvarUltimoSubSistemaSelecionado(pSistema,pSubSistema);}}
function GradIntra_Navegacao_ExibirBusca()
{if(gGradIntra_Navegacao_PainelDeBuscaAtual.hasClass(CONST_CLASS_CONTEUDOCARREGADO))
{GradIntra_Navegacao_ExibirBusca_CallBack();}
else
{var lUrlBusca="Buscas/";if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_MONITORAMENTO||gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_SISTEMA)
{lUrlBusca+=gGradIntra_Navegacao_SistemaAtual+"_"+gGradIntra_Navegacao_SubSistemaAtual;}
else if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_CLIENTES)
{if(gGradIntra_Navegacao_SubSistemaAtual==CONST_SUBSISTEMA_MIGRACAO)
{lUrlBusca+="Clientes_Assessores";}
else
{lUrlBusca+="Clientes";}}
else
{lUrlBusca+=gGradIntra_Navegacao_SistemaAtual;}
lUrlBusca+=".aspx";GradIntra_CarregarHtmlVerificandoErro(lUrlBusca,null,gGradIntra_Navegacao_PainelDeBuscaAtual.attr("id"),GradIntra_Navegacao_ExibirBusca_CallBack,{CustomInputs:[".Busca_Formulario input[type='checkbox']",".Busca_Resultados table thead tr td input[type='checkbox']"],HabilitarMascaras:true,HabilitarValidacoes:true,AtivarToolTips:true});}}
function GradIntra_Navegacao_ExibirBusca_CallBack()
{gGradIntra_Navegacao_PainelDeBuscaAtual.show().find("input[type='text']:eq(0)").focus();switch(gGradIntra_Navegacao_SistemaAtual)
{case CONST_SISTEMA_CLIENTES:GradIntra_Busca_ConfigurarGridDeResultados_Clientes();break;case CONST_SISTEMA_SEGURANCA:GradIntra_Busca_ConfigurarGridDeResultados_Seguranca();case CONST_SISTEMA_RISCO:GradIntra_Busca_ConfigurarGridDeResultados_Risco();break;}}
function GradIntra_Navegacao_ExibirFiltroDeRelatorio()
{gGradIntra_Navegacao_PainelDeBuscaAtual.removeClass(CONST_CLASS_CONTEUDOCARREGADO);var lUrlFiltro=gGradIntra_Navegacao_SistemaAtual+"/Relatorios/Filtros.aspx";GradIntra_CarregarHtmlVerificandoErro(lUrlFiltro,null,gGradIntra_Navegacao_PainelDeBuscaAtual.attr("id"),GradIntra_Navegacao_ExibirFiltroDeRelatorio_CallBack,{CustomInputs:[".Busca_Formulario input[type='checkbox']",".Busca_Resultados table thead tr td input[type='checkbox']"],HabilitarMascaras:true,HabilitarValidacoes:true,AtivarToolTips:true});}
function GradIntra_Navegacao_ExibirFiltroDeRelatorio_CallBack()
{gGradIntra_Navegacao_PainelDeBuscaAtual.removeClass(CONST_CLASS_CONTEUDOCARREGADO).show().find("input[type='text']:eq(0)").focus();}
function GradIntra_Navegacao_ExpandirTabelaDeBusca(pDivDeResultados,pIdDoGrid)
{if(pDivDeResultados.hasClass(CONST_CLASS_ITEM_EXPANDIDO))
{pDivDeResultados.removeClass(CONST_CLASS_ITEM_EXPANDIDO).attr("style",null);$("#"+pIdDoGrid).setGridHeight(96);}
else
{pDivDeResultados.addClass(CONST_CLASS_ITEM_EXPANDIDO).css({height:"501px"});$("#"+pIdDoGrid).setGridHeight(450);}}
function GradIntra_AdicionarItemNaListaDeItensSelecionados(pItem,pSistema,pExpandirAposIncluir)
{var lItem,lItemJson;if(pSistema==null||pSistema=="")
pSistema=gGradIntra_Navegacao_SistemaAtual;var lListaDeItens=$("#pnlConteudo_"+pSistema+" ul.ListaDeObjetos");if(pItem.Id)
{lItemJson=$.toJSON(pItem);lItem=pItem;}
else
{var lInputsJson=lListaDeItens.find("input[Propriedade='json']");var lJson;for(var a=0;a<lInputsJson.length;a++)
{lJson=lInputsJson[a].value;if(lJson==pItem)
{var lLi=$(lInputsJson[a]).parent();if(!lLi.hasClass(CONST_CLASS_ITEM_EXPANDIDO))
GradIntra_Navegacao_ExpandirItemSelecionado(lLi);return false;}}
lItemJson=pItem;lItem=$.evalJSON(pItem);}
var lClasseTemplate=CONST_CLASS_TEMPLATE;if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_SEGURANCA)
{lClasseTemplate="Template_Seguranca_"+lItem.TipoDeObjeto;}
var lNovoItem=lListaDeItens.find("li."+lClasseTemplate).clone();var lElemento,lPropriedade,lValor;lListaDeItens.children("li:eq(0)").after(lNovoItem);lNovoItem.find("[Propriedade]").each(function()
{lElemento=$(this);lPropriedade=lElemento.attr("Propriedade");if(lPropriedade=="json")
{lElemento.val(lItemJson);}
else
{lValor=eval("lItem."+lPropriedade);if(lPropriedade=="NomeCliente"&&lValor.length>26)
{lElemento.attr("title",lValor);lValor=lValor.substr(0,26)+" <small style='font-size:0.7em'>(...)</small>";}
if(!lValor||lValor=="")lValor="<small title='Não Disponível'>n/d</small>";lElemento.html(lValor);}});if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_CLIENTES)
{lNovoItem.find("h3").attr("class","Cliente_"+(lItem.TipoCliente=="PJ"?"PJ":lItem.Sexo));lNovoItem.find("ul.Detalhes li.Item_Doc label").html((lItem.TipoCliente=="PJ"?"CNPJ:":"CPF:"));}
else if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_SEGURANCA)
{lNovoItem.find("h3").attr("class","Seguranca_"+lItem.TipoDeObjeto.charAt(0));}
lNovoItem.removeClass(CONST_CLASS_TEMPLATE).removeClass(lClasseTemplate).addClass(CONST_CLASS_ITEM_ITEMDINAMICO).bind("mouseenter",lstItensSelecionados_LI_MouseEnter).bind("mouseleave",lstItensSelecionados_LI_MouseLeave);gGradIntra_Cadastro_ItemSendoEditado=lItem;if(pExpandirAposIncluir)
lNovoItem.show();return lNovoItem;}
function GradIntra_ExcluirItemDaListaDeItensSelecionados(pItem)
{pItem.remove();}
function GradIntra_Navegacao_ExibirConteudo()
{if(gGradIntra_Navegacao_PainelDeConteudoAtual.hasClass(CONST_CLASS_CONTEUDOCARREGADO))
{GradIntra_Navegacao_ExibirConteudo_CallBack();}
else
{GradIntra_CarregarHtmlVerificandoErro(gGradIntra_Navegacao_SistemaAtual+"/Default.aspx",null,gGradIntra_Navegacao_PainelDeConteudoAtual.attr("id"),GradIntra_Navegacao_ExibirConteudo_CallBack,{CustomInputs:[],HabilitarMascaras:true,HabilitarValidacoes:true,AtivarToolTips:true});}}
function GradIntra_Navegacao_ExibirConteudo_CallBack()
{gGradIntra_Navegacao_PainelDeConteudoAtual.show();var lListaDeObjetos=gGradIntra_Navegacao_PainelDeConteudoAtual.find(".ListaDeObjetos");if(lListaDeObjetos.length>0)
{if(lListaDeObjetos.find("li."+CONST_CLASS_ITEM_ITEMDINAMICO).length>0)
{lListaDeObjetos.show().next(".MenuDoObjeto").show().find("."+CONST_CLASS_ITEM_SELECIONADO).removeClass(CONST_CLASS_ITEM_SELECIONADO);}}
switch(gGradIntra_Navegacao_SubSistemaAtual)
{case CONST_SUBSISTEMA_NOVO_PF:GradIntra_Clientes_ReverterTipoDeClienteAtual("PF",true);GradIntra_Navegacao_ExibirFormularioDeNovoItem();break;case CONST_SUBSISTEMA_NOVO_PJ:GradIntra_Clientes_ReverterTipoDeClienteAtual("PJ",true);GradIntra_Navegacao_ExibirFormularioDeNovoItem();break;case CONST_SUBSISTEMA_NOVO_USUARIO:GradIntra_Seguranca_ReverterTipoDeObjetoDeSegurancaAtual(CONST_SEGURANCA_TIPODEOBJETO_USUARIO,true);GradIntra_Navegacao_ExibirFormularioDeNovoItem();break;case CONST_SUBSISTEMA_NOVO_GRUPO:GradIntra_Seguranca_ReverterTipoDeObjetoDeSegurancaAtual(CONST_SEGURANCA_TIPODEOBJETO_GRUPO,true);GradIntra_Navegacao_ExibirFormularioDeNovoItem();break;case CONST_SUBSISTEMA_NOVO_PERFIL:GradIntra_Seguranca_ReverterTipoDeObjetoDeSegurancaAtual(CONST_SEGURANCA_TIPODEOBJETO_PERFIL,true);GradIntra_Navegacao_ExibirFormularioDeNovoItem();break;case CONST_SUBSISTEMA_NOVO_PAPEL:GradIntra_Navegacao_ExibirFormularioDeNovoItem();break;case CONST_SUBSISTEMA_NOVO_PERFILDERISCO:GradIntra_Navegacao_ExibirFormularioDeNovoItem();break;case CONST_SUBSISTEMA_VARIAVEIS:case CONST_SUBSISTEMA_PESSOASVINCULADAS:GradIntra_Sistema_ExibirConteudo();break;}}
function GradIntra_Navegacao_ExpandirItemSelecionado(pLi)
{var lLista=gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.ListaDeObjetos");var lItemExpandido=lLista.find("li."+CONST_CLASS_ITEM_EXPANDIDO);if(lItemExpandido.hasClass("NovoItem"))
{GradIntra_ExibirMensagem("I","Favor terminar de incluir o novo item, ou cancelar a operação",true);return;}
lItemExpandido.removeClass("Expandida").css({opacity:0.5});pLi.addClass(CONST_CLASS_ITEM_EXPANDIDO);gGradIntra_Navegacao_PainelDeConteudoAtual.find("div.pnlFormulario").hide().find("."+CONST_CLASS_CONTEUDOCARREGADO).removeClass(CONST_CLASS_CONTEUDOCARREGADO);lLista.show();gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.MenuDoObjeto").show().children("li."+CONST_CLASS_ITEM_SELECIONADO).removeClass(CONST_CLASS_ITEM_SELECIONADO);gGradIntra_Cadastro_ItemSendoEditado=$.evalJSON(pLi.find("input[Propriedade='json']").val());GradIntra_Navegacao_ReverterTipoDeObjetoAtual(gGradIntra_Cadastro_ItemSendoEditado);window.setTimeout(function(){pLi.css({opacity:1});},300);}
function GradIntra_Navegacao_ExpandirDadosDoPrimeiroItemSelecionado()
{var lItem=gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.ListaDeObjetos li[class~='"+CONST_CLASS_ITEM_ITEMDINAMICO+"']:eq(0)");if(lItem.length>0)
{GradIntra_Navegacao_ExpandirItemSelecionado(lItem);}
else
{gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.ListaDeObjetos").hide().parent().find("ul.MenuDoObjeto").hide().parent().find(".pnlFormulario").hide();}}
function GradIntra_Navegacao_ReverterTipoDeObjetoAtual(pObjeto)
{if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_CLIENTES)
{GradIntra_Clientes_ReverterTipoDeClienteAtual(pObjeto.TipoCliente,true);}
else if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_SEGURANCA)
{GradIntra_Seguranca_ReverterTipoDeObjetoDeSegurancaAtual(pObjeto.TipoDeObjeto,true);}}
function GradIntra_Navegacao_ExibirFormulario(pUrl,pCallBack,pDados)
{if(pUrl.indexOf(".")==-1)
{console.log("GradIntra_Navegacao_ExibirFormulario(pURL)> pUrl inválida: ["+pUrl+"]");return false;}
var lCaminho=pUrl.substr(0,pUrl.indexOf(".")).replace(/\//gi,"_");var lUrl=gGradIntra_Navegacao_SistemaAtual+"/"+pUrl;var lIdDoDivFormulario="pnl"+gGradIntra_Navegacao_SistemaAtual+"_"+lCaminho;var lDivFormulario=$("#"+lIdDoDivFormulario);if(lDivFormulario.length==0)
{console.log("GradIntra_Navegacao_ExibirFormulario(pURL)> Sem pnlFormulario para ["+lIdDoDivFormulario+"]");return false;}
if(lUrl.indexOf("DadosCompletos")!=-1)
{if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_CLIENTES)
{lUrl=lUrl.replace("DadosCompletos","DadosCompletos_"+gGradIntra_Clientes_TipoDeClienteAtual);}
if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_SEGURANCA)
{lUrl=lUrl.replace("DadosCompletos","DadosCompletos_"+gGradIntra_Seguranca_TipoDeObjetoDeSegurancaAtual);}}
var pnlFormulario=lDivFormulario.parent();if(lDivFormulario.hasClass(CONST_CLASS_CONTEUDOCARREGADO))
{if(!lDivFormulario.is(":visible"))
{if(lDivFormulario.hasClass(CONST_CLASS_CAMPOSPREENCHIDOS))
{pnlFormulario.children("div").hide();lDivFormulario.fadeIn(300);}
else
{pnlFormulario.children("div").hide();lDivFormulario.fadeIn(300);if(pCallBack)
pCallBack();}}}
else
{pnlFormulario.addClass(CONST_CLASS_CARREGANDOCONTEUDO).children("div").hide().parent().find(".Aguarde").attr("style",null);window.setTimeout(function()
{if(!pDados||pDados==null)
{if(gGradIntra_Cadastro_ItemSendoEditado!=null)
{pDados={Acao:"CarregarHtmlComDados",Id:gGradIntra_Cadastro_ItemSendoEditado.Id,TipoDeObjeto:gGradIntra_Cadastro_ItemSendoEditado.TipoDeObjeto};}
else
{pDados={Acao:"CarregarHtml"};}}
GradIntra_Navegacao_CarregarFormulario(lUrl,lIdDoDivFormulario,pDados,pCallBack);},gGradIntra_Config_DelayDeRequest);}
gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.MenuDoObjeto").children("li").removeClass(CONST_CLASS_ITEM_SELECIONADO).find("a[href='"+pUrl+"']").parent().addClass(CONST_CLASS_ITEM_SELECIONADO);pnlFormulario.show();}
function GradIntra_Navegacao_CarregarFormulario(pUrl,pDivParaCarregar,pDadosDoRequest,pCallBack)
{var lDivId;if(pDivParaCarregar.attr)
{lDivId=pDivParaCarregar.attr("id");}
else
{lDivId=pDivParaCarregar;}
if(lDivId.charAt(0)!="#")
lDivId="#"+lDivId;GradIntra_CarregarHtmlVerificandoErro(pUrl,pDadosDoRequest,lDivId,function(pResposta)
{GradIntra_Navegacao_CarregarFormulario_CallBack(lDivId,pCallBack);},{CustomInputs:[lDivId+" input[type='checkbox']",lDivId+" input[type='radio']","table.AvaliacaoDaExperiencia tbody"],HabilitarMascaras:true,HabilitarValidacoes:true,AtivarToolTips:true});}
function GradIntra_Cadastro_LoadPage()
{GradIntra_Cadastro_InabilitarEstadoQuandoEstrangeiro
($("#cboClientes_DadosCompletos_Nacionalidade"),$("#cboClientes_DadosCompletos_EstadoDeNascimento"));GradIntra_Cadastro_InabilitarDadosComerciaisPF
($("#cboClientes_DadosCompletos_Profissao"),$('#txtClientes_DadosCompletos_CargoAtual'),$('#txtClientes_DadosCompletos_Empresa'),$('#txtClientes_DadosCompletos_RamoDeAtividade'),$('#txtClientes_DadosCompletos_EmailComercial'));GradIntra_Cadastro_EstadoCivil
($("#cboClientes_DadosCompletos_EstadoCivil"),$("#txtClientes_DadosCompletos_Conjuge"))}
function GradIntra_Navegacao_CarregarFormulario_CallBack(pDivId,pCallBack)
{var lDiv=$(pDivId);if(lDiv.parent().hasClass(CONST_CLASS_CARREGANDOCONTEUDO))
{var lDadosJson;lDadosJson=lDiv.find("input[type='hidden'].DadosJson").val();if(lDadosJson&&lDadosJson!="")
{GradIntra_ExibirObjetoNoFormulario($.evalJSON(lDadosJson),lDiv);lDiv.addClass(CONST_CLASS_CAMPOSPREENCHIDOS);if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_CLIENTES&&gGradIntra_Navegacao_SubSistemaAtual==CONST_SUBSISTEMA_BUSCA)
{if(gGradIntra_Cadastro_ItemSendoEditado.TipoCliente=="PF")
{GradIntra_Cadastro_LoadPage();}}}
lDadosJson=lDiv.find("input[type='hidden'].ListaJson").val();if(lDadosJson&&lDadosJson!="")
{lDadosJson=$.evalJSON(lDadosJson);lDiv.find("table.Lista tbody tr.ItemDinamico").remove();$(lDadosJson).each(function()
{GradIntra_ExibirObjetoNaLista(this,lDiv.find(".pnlFormulario_Campos"));});}
lDiv.hide();lDiv.parent().find(".Aguarde").animate
({marginTop:-50,opacity:0},{duration:400,specialEasing:{marginTop:"easeInQuad",opacity:"easeOutCubic"},complete:function()
{lDiv.parent().removeClass(CONST_CLASS_CARREGANDOCONTEUDO);lDiv.fadeIn(300);if(pCallBack)
pCallBack();}});}
else
{if(pCallBack)
pCallBack();}}
function GradIntra_Navegacao_ExibirFormularioDeNovoItem()
{gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.ListaDeObjetos li").removeClass(CONST_CLASS_ITEM_EXPANDIDO).parent().show().find("li.NovoItem").addClass(CONST_CLASS_ITEM_EXPANDIDO).show();gGradIntra_Cadastro_ItemSendoIncluido={Id:-1};gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.MenuDoObjeto").show().children("li").hide().filter(".ExibirEmNovo").show().find("a:eq(0)").click().parent().parent().find("li.TopoFundo").show();GradIntra_Cadastro_NovoItem();}
function GradIntra_Navegacao_OcultarFormularioDeNovoItem(pNaoSelecionarProximo)
{gGradIntra_Navegacao_PainelDeConteudoAtual.find("li.NovoItem").hide().removeClass(CONST_CLASS_ITEM_EXPANDIDO);gGradIntra_Cadastro_ItemSendoIncluido=null;if(!pNaoSelecionarProximo)
{gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.MenuDoObjeto li").show();GradIntra_Navegacao_IrParaSubSistema(gGradIntra_Navegacao_SistemaAtual,CONST_SUBSISTEMA_BUSCA);GradIntra_Navegacao_ExpandirDadosDoPrimeiroItemSelecionado();}}
﻿
function GradIntra_Busca_ConfigurarGridDeResultados_Clientes()
{$("#tblBusca_Clientes_Resultados").jqGrid({url:"Buscas/Clientes.aspx?Acao=Paginar",datatype:"json",mtype:"GET",colModel:[{label:"Código",name:"Id",jsonmap:"Id",index:"Id",width:70,align:"right",sortable:false},{label:"Cód. Bov.",name:"CodBovespa",jsonmap:"CodBovespa",index:"CodBovespa",width:70,align:"right",sortable:false},{label:"Cód. Bmf.",name:"CodBMF",jsonmap:"CodBMF",index:"CodBMF",width:70,align:"right",sortable:false},{label:"Nome",name:"NomeCliente",jsonmap:"NomeCliente",index:"NomeCliente",width:360,align:"left",sortable:false},{label:"CPF / CNPJ",name:"CPF",jsonmap:"CPF",index:"CPF",width:70,align:"left",sortable:false},{label:"Status",name:"Status",jsonmap:"Status",index:"Status",width:50,align:"left",sortable:false,hidden:true},{label:"Tipo",name:"TipoCliente",jsonmap:"TipoCliente",index:"TipoCliente",width:50,align:"left",sortable:false},{label:"Sexo",name:"Sexo",jsonmap:"Sexo",index:"Sexo",width:50,align:"left",sortable:false,hidden:true},{label:"Passo",name:"Passo",jsonmap:"Passo",index:"Passo",width:50,align:"left",sortable:false,hidden:true},{label:"Tem Pendência",name:"FlagPendencia",jsonmap:"FlagPendencia",index:"FlagPendencia",width:50,align:"left",sortable:false,hidden:true},{label:"Email",name:"Email",jsonmap:"Email",index:"Email",width:50,align:"left",sortable:false,hidden:true},{label:"Data de Cad.",name:"DataCadastro",jsonmap:"DataCadastroString",index:"DataCadastro",width:100,align:"left",sortable:false}],height:96,pager:"#pnlBusca_Clientes_Resultados_Pager",rowNum:20,sortname:"invid",sortorder:"desc",viewrecords:true,gridview:true,jsonReader:{root:"Itens",page:"PaginaAtual",total:"TotalDePaginas",records:"TotalDeItens",cell:"",id:"0",repeatitems:false},ondblClickRow:GradIntra_Busca_SelecionarItensIndividualmente});PageResize();}
function GradIntra_Busca_ConfigurarGridDeResultados_Seguranca()
{$("#tblBusca_Seguranca_Resultados").jqGrid({url:"Buscas/Seguranca.aspx?Acao=Paginar",datatype:"json",mtype:"GET",colModel:[{label:"Código",name:"Id",jsonmap:"Id",index:"Id",width:270,align:"left",sortable:false},{label:"Descrição",name:"Descricao",jsonmap:"Descricao",index:"Descricao",width:480,align:"left",sortable:false},{label:"Tipo De Objeto",name:"TipoDeObjeto",jsonmap:"TipoDeObjeto",index:"TipoDeObjeto",width:0,align:"left",sortable:false,hidden:true},{label:"Nome",name:"Nome",jsonmap:"Nome",index:"Nome",width:0,align:"left",sortable:false,hidden:true},{label:"Email",name:"Email",jsonmap:"Email",index:"Email",width:0,align:"left",sortable:false,hidden:true}],height:96,pager:"#pnlBusca_Seguranca_Resultados_Pager",rowNum:20,sortname:"invid",sortorder:"desc",viewrecords:true,gridview:true,jsonReader:{root:"Itens",page:"PaginaAtual",total:"TotalDePaginas",records:"TotalDeItens",cell:"",id:"0",repeatitems:false},ondblClickRow:GradIntra_Busca_SelecionarItensIndividualmente});PageResize();}
function GradIntra_Busca_ConfigurarGridDeResultados_Risco()
{$("#tblBusca_Risco_Resultados").jqGrid({url:"Buscas/Risco.aspx?Acao=Paginar",datatype:"json",mtype:"GET",colModel:[{label:"Código",name:"Id",jsonmap:"Id",index:"Id",width:100,align:"right",sortable:false},{label:"Descrição.",name:"Descricao",jsonmap:"Descricao",index:"Descricao",width:450,align:"left",sortable:false},{label:"Regras",name:"Regras",jsonmap:"Regras",index:"Regras",width:50,align:"left",sortable:false,hidden:true}],height:96,pager:"#pnlBusca_Risco_Resultados_Pager",rowNum:20,sortname:"invid",sortorder:"desc",viewrecords:true,gridview:true,jsonReader:{root:"Itens",page:"PaginaAtual",total:"TotalDePaginas",records:"TotalDeItens",cell:"",id:"0",repeatitems:false},ondblClickRow:GradIntra_Busca_SelecionarItensIndividualmente});PageResize();}
function GradIntra_Busca_BuscarItensParaSelecao(pObjetoDeParametros,pDivDeFormulario,pURL)
{if(!pObjetoDeParametros||pObjetoDeParametros==null)
pObjetoDeParametros=GradIntra_InstanciarObjetoDosControles(pDivDeFormulario);pObjetoDeParametros.Acao="BuscarItensParaSelecao";pDivDeFormulario.find(".btnBusca").html("Aguarde...").parent().find("input, select, button").attr("disabled","disabled");var lDivId=pDivDeFormulario.closest(".Busca_Container").attr("id");GradIntra_CarregarJsonVerificandoErro(pURL,pObjetoDeParametros,function(pResposta){GradIntra_Busca_BuscarItensParaSelecao_Callback(pResposta,lDivId);});}
function GradIntra_Busca_BuscarItensParaSelecao_Callback(pResposta,pIdDoPainelDeBusca)
{var lPainelDeBusca=$("#"+pIdDoPainelDeBusca);var lIdPainelDeBusca=lPainelDeBusca.attr("id");GradIntra_ExibirMensagem("A",pResposta.Mensagem,true);var lGrid=lPainelDeBusca.find(".Busca_Resultados table.ui-jqgrid-btable")[0];lGrid.addJSONData(pResposta.ObjetoDeRetorno);lPainelDeBusca.find(".Busca_Formulario").find(".btnBusca").html("Buscar").parent().find("input, select, button").attr("disabled",null);}
function GradIntra_Busca_SelecionarItensIndividualmente(rowid,iRow,iCol,e)
{var lItemNovoNaListaDeSelecionados;var lJson;var lObjeto=$(e.currentTarget).getRowData(rowid);lJson=$.toJSON(lObjeto);lItemNovoNaListaDeSelecionados=GradIntra_AdicionarItemNaListaDeItensSelecionados(lJson,null,true);if(lItemNovoNaListaDeSelecionados)
GradIntra_Navegacao_ExpandirDadosDoPrimeiroItemSelecionado();return false;}
function GradIntra_Busca_BuscarItensParaListagemSimples(pDivDeFormulario,pDivDeResultados,pURL,pOpcoesDeBusca)
{if(pOpcoesDeBusca)
{if(pOpcoesDeBusca.CamposObrigatorios&&pOpcoesDeBusca.CamposObrigatorios!=null)
{var lCampo;var lCamposValidos=true;$(pOpcoesDeBusca.CamposObrigatorios).each(function()
{if(lCamposValidos)
{lCampo=$("#"+this);lCamposValidos=!((lCampo.val()=="")||(lCampo.val()=="__/__/____"&&lCampo.hasClass(CONST_CLASS_PICKERDEDATA)));}});if(!lCamposValidos)
{var lLabel=lCampo.prev("label").html();alert("Favor preencher o campo '"+lLabel+"'");lCampo.focus();return;}}}
var lData;lData=GradIntra_InstanciarObjetoDosControles(pDivDeFormulario);lData.Acao="BuscarItensParaListagemSimples";pDivDeFormulario.find("input, select, button").attr("disabled","disabled");pDivDeResultados.hide().parent().addClass(CONST_CLASS_CARREGANDOCONTEUDO).find(".Aguarde").attr("style",null).show().parent().show();window.setTimeout(function(){GradIntra_CarregarHtmlVerificandoErro(pURL,lData,pDivDeResultados,GradIntra_Busca_BuscarItensParaListagemSimples_Callback,{CustomInputs:[".GridIntranet td input[type='checkbox']"]});},gGradIntra_Config_DelayDeRequest);return;}
function GradIntra_Busca_BuscarItensParaListagemSimples_Callback(pResposta,pDivDeResultados)
{pDivDeResultados.parent().find(".Aguarde").animate
({marginTop:-80,opacity:0},{duration:400,specialEasing:{marginTop:"easeOutQuad",opacity:"easeOutCubic"},complete:function()
{$("#pnlConteudo .Busca_Container:visible").find("input, select, button").attr("disabled",null);pDivDeResultados.parent().removeClass(CONST_CLASS_CARREGANDOCONTEUDO);pDivDeResultados.fadeIn(300);}});}
﻿
var gGradIntra_Cadastro_ItemSendoIncluido=null;var gGradIntra_Cadastro_ItemSendoEditado=null;var gGradIntra_Cadastro_ItemFilhoSendoEditado=null;var gGradIntra_Cadastro_DadosDoItemFilhoAtual=null;function GradIntra_Cadastro_NovoItem()
{gGradIntra_Cadastro_ItemSendoIncluido={Id:-1};gGradIntra_Cadastro_ItemSendoEditado=null;}
function GradIntra_Cadastro_SalvarFormulario(pDivDeFormulario,pUrl,pAcao,pCallBackAntesDeEnviar,pCallBackAposEnviar)
{if(pDivDeFormulario.validationEngine({returnIsValid:true}))
{var lDivId=pDivDeFormulario.attr("id");var lObjeto=GradIntra_InstanciarObjetoDosControles(pDivDeFormulario);if(lObjeto.ParentId)
{lObjeto.ParentId=gGradIntra_Cadastro_ItemSendoEditado.Id;}
var lDados=new Object();lDados.Acao=pAcao;lDados.ObjetoJson=$.toJSON(lObjeto);if(pCallBackAntesDeEnviar&&pCallBackAntesDeEnviar!=null)
pCallBackAntesDeEnviar(lObjeto);GradIntra_CarregarJsonVerificandoErro(pUrl,lDados,function(pResposta)
{GradIntra_Cadastro_SalvarFormulario_CallBack(pResposta,lDivId,pCallBackAposEnviar);});pDivDeFormulario.find("input, select").attr("disabled","disabled");}
else
{GradIntra_ExibirMensagem("A","Existem campos inválidos, favor verificar");}}
function GradIntra_Cadastro_SalvarFormulario_CallBack(pResposta,pIdDoDivDeFormulario,pCallBackAposEnviar)
{$("#"+pIdDoDivDeFormulario).find("input, select, button").attr("disabled",null);if(pResposta.TemErro)
{GradIntra_TratarRespostaComErro(pResposta);}
else
{GradIntra_ExibirMensagem("A",pResposta.Mensagem,true);if(pResposta.ObjetoDeRetorno)
if(pResposta.ObjetoDeRetorno.IdCadastrado)
$("#"+pIdDoDivDeFormulario).find("input[Propriedade='Id']").val(pResposta.ObjetoDeRetorno.IdCadastrado);if(pCallBackAposEnviar&&pCallBackAposEnviar!=null)
pCallBackAposEnviar(pResposta);}}
function GradIntra_Cadastro_NovoItemFilho(pSender)
{if($(pSender).closest("table.Lista").find("tr.Editando").length>0)
{GradIntra_ExibirMensagem("A","Favor cancelar ou confirmar a edição do item atual antes de criar um novo.",true);return false;}
var lDivCampos=$(pSender).closest("table.Lista").next("div.pnlFormulario_Campos");lDivCampos.find("input, select, textarea").val("");lDivCampos.show();return false;}
function GradIntra_Cadastro_SalvarItemFilho(pTipoDeItem,pDivDeFormulario,pURL)
{if(pDivDeFormulario.validationEngine({returnIsValid:true}))
{gGradIntra_Cadastro_ItemFilhoSendoEditado=GradIntra_InstanciarObjetoDosControles(pDivDeFormulario);gGradIntra_Cadastro_ItemFilhoSendoEditado.ParentId=gGradIntra_Cadastro_ItemSendoEditado.Id;gGradIntra_Cadastro_ItemFilhoSendoEditado.IdDoFormulario=pDivDeFormulario.attr("id");gGradIntra_Cadastro_ItemFilhoSendoEditado.TipoDeItem=pTipoDeItem;if(pTipoDeItem=="Regra")
{gGradIntra_Cadastro_ItemFilhoSendoEditado.ValoresDosParametros=new Array();var lInputsParametros=$("#pnlRisco_Formularios_Dados_Regras input[IdParametro]");lInputsParametros.each(function()
{var lInput=$(this);gGradIntra_Cadastro_ItemFilhoSendoEditado.ValoresDosParametros.push({IdParametro:lInput.attr("IdParametro"),Valor:lInput.val()});});}
var lDados={Acao:"Salvar",ObjetoJson:$.toJSON(gGradIntra_Cadastro_ItemFilhoSendoEditado),TipoDeObjetoPai:gGradIntra_Cadastro_ItemSendoEditado.TipoDeObjeto};pDivDeFormulario.find("input, select, button").attr("disabled","disabled");GradIntra_ExibirMensagem("I","Enviando dados, por favor aguarde...");GradIntra_CarregarJsonVerificandoErro(pURL,lDados,GradIntra_Cadastro_SalvarItemFilho_CallBack);}
else
{GradIntra_ExibirMensagem("A","Existem campos inválidos, favor verificar");}
return false;}
function GradIntra_Cadastro_SetaPrincipalEndereco()
{var lTable=$("#tblCadastro_EnderecosDoCliente");var lInput=lTable.find("tbody tr input[Propriedade='json']");if(gGradIntra_Cadastro_ItemFilhoSendoEditado.FlagCorrespondencia==true)
{lInput.each(function()
{var lValueInput=$(this);lValueInput.val(lValueInput.val().replace('"FlagCorrespondencia":true','"FlagCorrespondencia":false','gi'));});}}
function GradIntra_Cadastro_SetaPrincipalContaBancaria()
{var lTable=$("#tblCadastro_ContasDoCliente");var lInput=lTable.find("tbody tr input[Propriedade='json']");if(gGradIntra_Cadastro_ItemFilhoSendoEditado.Principal==true)
{lInput.each(function()
{var lValueInput=$(this);lValueInput.val(lValueInput.val().replace('"Principal":true','"Principal":false','gi'));});}}
function GradIntra_Cadastro_SetaPrincipalTelefone()
{var lTable=$("#tblCadastro_TelefonesDoCliente");var lInput=lTable.find("tbody tr input[Propriedade='json']");if(gGradIntra_Cadastro_ItemFilhoSendoEditado.Principal==true)
{lInput.each(function()
{var lValueInput=$(this);lValueInput.val(lValueInput.val().replace('"Principal":true','"Principal":false','gi'));});}}
function GradIntra_Cadastro_SetaPrincipalPessoasAutorizadas()
{var lTable=$("#tblCadastro_PessoasAutorizadas");var lInput=lTable.find("tbody tr input[Propriedade='json']");if(gGradIntra_Cadastro_ItemFilhoSendoEditado.FlagPrincipal==true)
{lInput.each(function()
{var lValueInput=$(this);lValueInput.val(lValueInput.val().replace('"FlagPrincipal":true','"FlagPrincipal":false','gi'));});}}
function GradIntra_Cadastro_SetaPrincipalItemFilho()
{switch(gGradIntra_Cadastro_ItemFilhoSendoEditado.TipoDeItem)
{case"Endereco":GradIntra_Cadastro_SetaPrincipalEndereco();break;case"Conta":GradIntra_Cadastro_SetaPrincipalContaBancaria();break;case"Telefone":GradIntra_Cadastro_SetaPrincipalTelefone();break;case"Emitente":GradIntra_Cadastro_SetaPrincipalPessoasAutorizadas();break;}}
function GradIntra_Cadastro_SalvarItemFilho_CallBack(pResposta)
{var lDivCampos=$("#"+gGradIntra_Cadastro_ItemFilhoSendoEditado.IdDoFormulario);if(pResposta.ObjetoDeRetorno&&pResposta.ObjetoDeRetorno.IdCadastrado)
gGradIntra_Cadastro_ItemFilhoSendoEditado.Id=pResposta.ObjetoDeRetorno.IdCadastrado;GradIntra_Cadastro_SetaPrincipalItemFilho();GradIntra_ExibirObjetoNaLista(gGradIntra_Cadastro_ItemFilhoSendoEditado,lDivCampos);lDivCampos.find("input, select, button").attr("disabled",null).val("");lDivCampos.hide();gGradIntra_Cadastro_DadosDoItemFilhoAtual=null;GradIntra_ExibirMensagem("I",pResposta.Mensagem,true);}
function GradIntra_Cadastro_ExcluirItemFilho(pUrl,pSender)
{if(confirm("Tem certeza que deseja excluir este item?"))
{var lTR=$(pSender).closest("tr");var lTBody=lTR.closest("tbody");if((lTR.attr("rel")+"")!="")
{var lDados=new Object();lDados.Id=lTR.attr("rel");lDados.Acao="Excluir";GradIntra_CarregarJsonVerificandoErro(pUrl,lDados,function(pResposta){GradIntra_Cadastro_ExcluirItemFilho_CallBack(pResposta,lTR);});}
if(lTBody.children("tr").length==2)
{lTBody.find("tr.Nenhuma").show().parent().find("thead").hide();}}
return false;}
function GradIntra_Cadastro_ExcluirItemFilho_CallBack(pResposta,pTR)
{GradIntra_ExibirMensagem("I",pResposta.Mensagem);pTR.remove();}
function GradIntra_Cadastro_EditarItemFilho(pSender)
{var lTR=$(pSender).closest("tr");var lObjeto=$.evalJSON(lTR.find("td input[Propriedade='json']").val());var lDivCampos=lTR.closest("table").next("div.pnlFormulario_Campos");lObjeto.Estado="Modificado";GradIntra_ExibirObjetoNoFormulario(lObjeto,lDivCampos);GradIntra_Cadastro_Enderecos_InabilitarEstadoQuandoEstrangeiro($("#cboClientes_Enderecos_Pais"),$("#cboClientes_Enderecos_Estado"));lTR.addClass("Editando");return false;}
function GradIntra_Cadastro_CancelarEdicaoDeItemFilho(pSender)
{if(confirm("Descartar as alterações feitas neste item?"))
{var lTR=$(pSender).closest("tr");var lDivCampos=lTR.closest("table").next("div.pnlFormulario_Campos");lTR.removeClass("Editando");lDivCampos.find("input, select, button").val("");lDivCampos.hide();}
return false;}
function GradIntra_Cadastro_Enderecos_InabilitarEstadoQuandoEstrangeiro(pComboNacionalidade,pCampo)
{if(pComboNacionalidade.val()!='BRA')
{$(pCampo).removeClass('validate[required]').attr("disabled",true).val('');}
else
{$(pCampo).addClass('validate[required]').attr("disabled",false);}}
function GradIntra_Cadastro_InabilitarEstadoQuandoEstrangeiro(pValor,pCombo)
{if(pValor.val()=='3')
{$(pCombo).removeClass('validate[required]').attr("disabled",true).val('');var lComboBrasil=$("#cboClientes_DadosCompletos_PaisDeNascimento option[value='BRA']");lComboBrasil.hide().parent()
if(lComboBrasil.val()=="BRA")
lComboBrasil.val("");}
else
{$(pCombo).addClass('validate[required]').attr("disabled",false);$("#cboClientes_DadosCompletos_PaisDeNascimento option[value='BRA']").show().parent().val("BRA")}
return false;}
function GradIntra_Cadastro_InabilitarDadosComerciaisPF(pValorSelecionado,pLabelCargoAtual,pLabelEmpresa,pComboRamoAtividade,pLabelEmailComercial)
{if(pValorSelecionado.val()=="923")
{$(pLabelCargoAtual).val('').removeClass("validate[required,length[5,100]]");$(pLabelEmpresa).val('').removeClass("validate[required,length[5,100]]");$(pComboRamoAtividade).removeClass('validate[required]').attr("disabled",true).val('');$(pLabelEmailComercial).val('').removeClass("validate[custom[email],required,length[0,256]]").addClass("validate[custom[email]");}
else
{$(pLabelCargoAtual).attr("disabled",false).addClass("validate[required,length[5,100]]");$(pLabelEmpresa).attr("disabled",false).addClass("validate[required,length[5,100]]");$(pComboRamoAtividade).addClass('validate[required]').attr("disabled",false);$(pLabelEmailComercial).attr("disabled",false).addClass("validate[custom[email],required,length[0,256]]");}
return false;}
function GradIntra_Cadastro_EstadoCivil(pValorSelecionado,pCampoAcao)
{if(pValorSelecionado.val()==1||(pValorSelecionado.val()==2)||(pValorSelecionado.val()==4))
{$(pCampoAcao).attr("disabled",true).removeClass('validate[length[5,100]]').val('');}
else
{$(pCampoAcao).attr("disabled",false).addClass('validate[length[5,100]]');}
return false;}
﻿
function GradIntra_Relatorio_OcultarExibirFiltros(pDivDeFormulario,pCodigoDoRelatorio)
{var lParagrafoBotao=pDivDeFormulario.find(".btnBusca").closest("p");pDivDeFormulario.find("p[class^=R0]").hide();if(pCodigoDoRelatorio!="")
{gGradIntra_Relatorios_RelatorioAtualSelecionado=pCodigoDoRelatorio;pDivDeFormulario.find("p."+pCodigoDoRelatorio).show();lParagrafoBotao.show();}
else
{gGradIntra_Relatorios_RelatorioAtualSelecionado=null;lParagrafoBotao.hide();}
if(pCodigoDoRelatorio=="R002"||pCodigoDoRelatorio=="R003"||pCodigoDoRelatorio=="R007"||pCodigoDoRelatorio=="R005"||pCodigoDoRelatorio=="R006"||pCodigoDoRelatorio=="R008")
{pDivDeFormulario.addClass("Busca_Formulario_3Linhas");pDivDeFormulario.removeClass("Busca_Formulario_2Linhas");}
else
{pDivDeFormulario.addClass("Busca_Formulario_2Linhas");pDivDeFormulario.removeClass("Busca_Formulario_3Linhas");}}
function GradInfra_Relatorio_ImprimirFichaDuc_PF()
{var lDados={Acao:"ImprimirFichaDuc_PF",Id:gGradIntra_Cadastro_ItemSendoEditado.Id};GradIntra_CarregarJsonVerificandoErro("Clientes/Formularios/Acoes/VerFichaCadastral.aspx",lDados,GradInfra_Relatorio_ImprimirFichaDuc_PF_Callback);return false;}
function GradInfra_Relatorio_ImprimirFichaDuc_PF_Callback(pResposta)
{window.open(pResposta.Mensagem);GradIntra_ExibirMensagem("I","Ficha cadastral gerada com sucesso.");}
﻿
function PageLoad()
{$("#txtLogin").focus();}
function GradIntra_EfetuarLogin()
{$("#btnLogin").attr("disabled","disabled");$.ajax({url:"Login.aspx",type:"post",dataType:"json",cache:false,data:{acao:"EfetuarLogin",usuario:$("#txtLogin").val(),senha:$("#txtSenha").val()},success:GradIntra_EfetuarLogin_CallBack});return false;}
function GradIntra_EfetuarLogin_CallBack(pRetorno)
{if(pRetorno.TemErro)
{$("#pnlErro").html(pRetorno.Mensagem).show();$("#btnLogin").attr("disabled",null);}
else
{document.location=pRetorno.Mensagem;}}﻿
var gGradIntra_Clientes_TipoDeClienteAtual="PF";var gGradIntra_Clientes_SincronizacaoComSinacorAtual=null;function GradIntra_Clientes_InstanciarParametrosDeBusca()
{var lData=new Object();lData.TermoDeBusca=$("#txtBusca_Clientes_Termo").val();lData.BuscarPor=$("#cboBusca_Clientes_BuscarPor").val();lData.Tipo=$("#cboBusca_Clientes_Tipo").val();lData.Status_Ativo=$("#chkBusca_Clientes_Status_Ativo").attr("checked");lData.Status_Inativo=$("#chkBusca_Clientes_Status_Inativo").attr("checked");lData.Passo_Visitante=$("#chkBusca_Clientes_Passo_Visitante").attr("checked");lData.Passo_Cadastrado=$("#chkBusca_Clientes_Passo_Cadastrado").attr("checked");lData.Passo_ExportadoSinacor=$("#chkBusca_Clientes_Passo_ExportadoSinacor").attr("checked");lData.Pendencia_ComPendenciaCadastral=$("#chkBusca_Clientes_Pendencia_ComPendenciaCadastral").attr("checked");lData.Pendencia_ComSolicitacaoAlteracao=$("#chkBusca_Clientes_Pendencia_ComSolicitacaoAlteracao").attr("checked");return lData;}
function GradIntra_Clientes_ReverterTipoDeClienteAtual(pPessoaFisicaOuJuridica,pRecarregarConteudo)
{gGradIntra_Clientes_TipoDeClienteAtual=pPessoaFisicaOuJuridica;if(pRecarregarConteudo)
$("#pnlClientes_Formularios_Dados_DadosCompletos").removeClass(CONST_CLASS_CONTEUDOCARREGADO);if(gGradIntra_Clientes_TipoDeClienteAtual=="PF")
{$("#lstMenuCliente li.Tipo_J").hide();$("#lstMenuCliente li.Tipo_F").show();}
else
{$("#lstMenuCliente li.Tipo_J").show();$("#lstMenuCliente li.Tipo_F").hide();}}
function GradIntra_Clientes_SalvarDadosCompletosDoCliente()
{var lDiv=$("#pnlClientes_Formularios_Dados_DadosCompletos");var lUrl="Clientes/Formularios/Dados/DadosCompletos_"+gGradIntra_Clientes_TipoDeClienteAtual+".aspx";if(gGradIntra_Cadastro_ItemSendoIncluido!=null)
{GradIntra_Cadastro_SalvarFormulario(lDiv,lUrl,"Cadastrar",GradIntra_Clientes_GuardarObjetoDeClienteInstanciado,GradIntra_Clientes_SalvarDadosCompletosDoCliente_CallBack);}
else
{GradIntra_Cadastro_SalvarFormulario(lDiv,lUrl,"Atualizar",null,null);}
return false;}
function GradIntra_Clientes_GuardarObjetoDeClienteInstanciado(pObjeto)
{gGradIntra_Cadastro_ItemSendoIncluido=pObjeto;}
function GradIntra_Clientes_SalvarDadosCompletosDoCliente_CallBack(pResposta)
{gGradIntra_Cadastro_ItemSendoEditado=gGradIntra_Cadastro_ItemSendoIncluido;gGradIntra_Cadastro_ItemSendoEditado.Id=pResposta.ObjetoDeRetorno.IdCadastrado;gGradIntra_Cadastro_ItemSendoEditado.CodBovespa="n/d";gGradIntra_Cadastro_ItemSendoEditado.CodBMF="n/d";gGradIntra_Cadastro_ItemSendoEditado.DataCadastroString=GradAux_DataDeHoje();GradIntra_Navegacao_OcultarFormularioDeNovoItem(true);gGradIntra_Navegacao_PainelDeConteudoAtual.find("ul.MenuDoObjeto li").show();var lNovaLI=GradIntra_AdicionarItemNaListaDeItensSelecionados(gGradIntra_Cadastro_ItemSendoEditado,null,true);lNovaLI.addClass(CONST_CLASS_ITEM_EXPANDIDO);$("#lnkSubMenu_Cadastro_Busca").closest("ul").find("li."+CONST_CLASS_ITEM_SELECIONADO).removeClass(CONST_CLASS_ITEM_SELECIONADO)
$("#lnkSubMenu_Cadastro_Busca").parent().addClass(CONST_CLASS_ITEM_SELECIONADO)}
function GradIntra_Clientes_SalvarItemFilhoDoCliente(pTipoDeFilho)
{var lDiv,lURL;lDiv=$("#pnlClientes_Formularios_Dados_"+pTipoDeFilho);lURL="Clientes/Formularios/Dados/"+pTipoDeFilho+".aspx";GradIntra_Cadastro_SalvarFormulario(lDiv,lURL,"Salvar",null,null);}
function GradIntra_Clientes_IniciarSincronizacaoComSinacor()
{if(gGradIntra_Cadastro_ItemSendoEditado.Id)
{$("#pnlClientes_SincronizarComSinacor_Requisicao").hide();$("#pnlClientes_SincronizarComSinacor_Submit").hide();$("#pnlClientes_SincronizarComSinacor_EmAndamento").show();var lDados={Acao:"SincronizarComSinacor",Id:gGradIntra_Cadastro_ItemSendoEditado.Id};GradIntra_CarregarJsonVerificandoErro("Clientes/Formularios/Acoes/SincronizarComSinacor.aspx",lDados,GradIntra_Clientes_IniciarSincronizacaoComSinacor_CallBack);}}
function GradIntra_Clientes_IniciarSincronizacaoComSinacor_CallBack(pResposta)
{GradIntra_ExibirMensagem("I",pResposta.Mensagem,true);gGradIntra_Clientes_SincronizacaoComSinacorAtual=pResposta.ObjetoDeRetorno;gGradIntra_Clientes_SincronizacaoComSinacorAtual.Interval=window.setInterval(GradIntra_Clientes_VerificarSincronizacaoComSinacor,5000);}
function GradIntra_Clientes_VerificarSincronizacaoComSinacor()
{if(gGradIntra_Clientes_SincronizacaoComSinacorAtual)
{var lDados={Acao:"VerificarSincronizacao",IdDaSincronizacao:gGradIntra_Clientes_SincronizacaoComSinacorAtual.IdDaSincronizacao};GradIntra_CarregarJsonVerificandoErro("Clientes/Formularios/Acoes/SincronizarComSinacor.aspx",lDados,GradIntra_Clientes_VerificarSincronizacaoComSinacor_CallBack);}}
function GradIntra_Clientes_VerificarSincronizacaoComSinacor_CallBack(pResposta)
{if(pResposta.Mensagem!="INEXISTENTE")
{gGradIntra_Clientes_SincronizacaoComSinacorAtual=pResposta.ObjetoDeRetorno;if(gGradIntra_Clientes_SincronizacaoComSinacorAtual.StatusDaSincronizacao=="Finalizada")
{GradIntra_ExibirMensagem("I","Sincronização finalizada com sucesso!",true);GradIntra_Clientes_SincronizacaoComSinacor_FinalizarSincronizacaoAtual();}
else if(gGradIntra_Clientes_SincronizacaoComSinacorAtual.StatusDaSincronizacao=="Com Erro")
{GradIntra_ExibirMensagem("E",gGradIntra_Clientes_SincronizacaoComSinacorAtual.MensagemDeFinalizacao);GradIntra_Clientes_SincronizacaoComSinacor_FinalizarSincronizacaoAtual();}
else
{GradIntra_ExibirMensagem("I","Sincronização em andamento...",true);}}
else
{window.clearInterval(gGradIntra_Clientes_SincronizacaoComSinacorAtual.Interval);}}
function GradIntra_Clientes_SincronizacaoComSinacor_FinalizarSincronizacaoAtual()
{window.clearInterval(gGradIntra_Clientes_SincronizacaoComSinacorAtual.Interval);gGradIntra_Clientes_SincronizacaoComSinacorAtual=null;$("#pnlClientes_SincronizarComSinacor_Requisicao").show();$("#pnlClientes_SincronizarComSinacor_Submit").show();$("#pnlClientes_SincronizarComSinacor_EmAndamento").hide();}
function GradIntra_Clientes_MigracaoEntreAssessores_VerificarMarcados()
{var lChecks=$("#tblClientes_MigracaoEntreAssessores_ListaDeClientes tbody tr td:first-child input[type='checkbox']:checked");var lpnlAlertaSelecionar=$("#pnlClientes_MigracaoEntreAssessores_AlertaSelecionar");var lpnlFormularioPara=$("#pnlClientes_MigracaoEntreAssessores_FormularioPara");if(lChecks.length>0)
{lpnlAlertaSelecionar.hide();lpnlFormularioPara.find("label").html("Migrar ["+lChecks.length+"] clientes para:").parent().show();}
else
{lpnlAlertaSelecionar.show();lpnlFormularioPara.hide();}}
function GradIntra_Clientes_MigracaoEntreAssessores_RealizarMigracao()
{var lChecks=$("#tblClientes_MigracaoEntreAssessores_ListaDeClientes tbody tr td:first-child input[type='checkbox']:checked");if(lChecks.length>0)
{var lDados={Acao:"RealizarMigracao",AssessorDe:$("#cboClientes_MigracaoEntreAssessores_AssessorDe").val(),AssessorPara:$("#cboClientes_MigracaoEntreAssessores_AssessorPara").val(),IDsDosClientes:""};if((lDados.AssessorDe=="")||(lDados.AssessorPara=="")||(lDados.AssessorDe==lDados.AssessorPara))
{GradIntra_ExibirMensagem("A","Assessores inválidos",true);}
else
{var lCheck;lChecks.each(function()
{lCheck=$(this);lDados.IDsDosClientes+=lCheck.attr("rel")+",";});GradIntra_CarregarJsonVerificandoErro("Clientes/Formularios/MigracaoEntreAssessores.aspx",lDados,GradIntra_Clientes_MigracaoEntreAssessores_RealizarMigracao_CallBack);}}
else
{GradIntra_ExibirMensagem("A","Favor escolher clientes para migrar",true);}}
function GradIntra_Clientes_MigracaoEntreAssessores_RealizarMigracao_CallBack(pResposta)
{GradIntra_ExibirMensagem("I","Migração efetuada com sucesso!",true);var lTRs=$("#tblClientes_MigracaoEntreAssessores_ListaDeClientes tbody tr td:first-child input[type='checkbox']:checked").closest("tr");lTRs.remove();var lCountRestantes=$("#tblClientes_MigracaoEntreAssessores_ListaDeClientes tbody tr").length;if(lCountRestantes==0)
{$("#cboClientes_MigracaoEntreAssessores_AssessorDe").val("");cboClientes_MigracaoEntreAssessores_AssessorDe_Change();}
else
{$("#cboClientes_MigracaoEntreAssessores_AssessorPara").val("");$("#tblClientes_MigracaoEntreAssessores_ListaDeClientes tfoot tr td").html(lCountRestantes+" clientes encontrados.");GradIntra_Clientes_MigracaoEntreAssessores_VerificarMarcados();}}
function GradIntra_Clientes_Suitability_VerificarExistencia()
{var lTemResultado=false;var lResultado=$("#hidCliente_Suitability_Resultado").val();if(lResultado&&lResultado!="")
{lResultado=$.evalJSON(lResultado);lTemResultado=true;}
if(lTemResultado)
{var lClasseResultado="1";var lTexto="<span>Baixo Risco</span>";var lImg=$("#imgClientes_Suitability_ImagemDeCapa").attr("src");if(lResultado.Resultado==CONST_SUITABILITY_RESULTADO_2)
{lClasseResultado="2";lTexto="<span>Médio Risco sem</span><span class='SegundaLinha'>Renda Variável</span>";}
else if(lResultado.Resultado==CONST_SUITABILITY_RESULTADO_3)
{lClasseResultado="3";lTexto="<span>Médio Risco com</span><span class='SegundaLinha'>Renda Variável</span>";}
else if(lResultado.Resultado==CONST_SUITABILITY_RESULTADO_4)
{lClasseResultado="4";lTexto="<span>Arrojado</span>";}
lImg=lImg.replace(/_\d.png/,"_"+lClasseResultado+".png")
$("#pnlCliente_Suitability_Resultado").children(".Resultado").hide().parent().children(".Resultado"+lClasseResultado).show();$("#imgClientes_Suitability_ImagemDeCapa").attr("src",lImg).next("label").html(lTexto);$("#pnlCliente_Suitability_Questionario").hide();$("#pnlCliente_Suitability_BotaoEnviar").hide();$("#pnlCliente_Suitability_Resultado").show();}
else
{$("#pnlCliente_Suitability_Resultado").hide();$("#pnlCliente_Suitability_Questionario").show();$("#pnlCliente_Suitability_BotaoEnviar").show();}}
function GradIntra_Clientes_Suitability_EnviarRespostas()
{var lDados={Acao:"Salvar",Id:gGradIntra_Cadastro_ItemSendoEditado.Id,Respostas:""};if($("[name^='rdoSuit_']:checked").length<18)
{alert("Existem questões não respondidas, favor preencher o formulário completo.");return false;}
var lId;for(var a=1;a<=13;a++)
{lId="rdoSuit_"+((a<10)?"0":"")+a;lDados.Respostas+=""+a+":"+$("[name^='"+lId+"']:checked").val()+",";}
lDados.Respostas+="14:"+$("[name='rdoSuit_14_01']:checked").val()+",";lDados.Respostas+="15:"+$("[name='rdoSuit_14_02']:checked").val()+",";lDados.Respostas+="16:"+$("[name='rdoSuit_14_03']:checked").val()+",";lDados.Respostas+="17:"+$("[name='rdoSuit_14_04']:checked").val()+",";lDados.Respostas+="18:"+$("[name='rdoSuit_14_05']:checked").val()+"";GradIntra_CarregarJsonVerificandoErro("Clientes/Formularios/Acoes/Suitability.aspx",lDados,GradIntra_Clientes_Suitability_EnviarRespostas_CallBack);}
function GradIntra_Clientes_Suitability_EnviarRespostas_CallBack(pResposta)
{$("#hidCliente_Suitability_Resultado").val($.toJSON(gGradIntra_Clientes_Suitability_ResultadoAtual));GradIntra_Clientes_Suitability_VerificarExistencia();GradIntra_ExibirMensagem("I",pResposta.Mensagem,true);}
function GradIntra_Clientes_Suitability_RefazerTeste()
{$("#pnlCliente_Suitability_Resultado").hide();$("#pnlCliente_Suitability_Questionario").show();$("#pnlCliente_Suitability_BotaoEnviar").show();}
function GradIntra_Clientes_Suitability_DownloadPDF()
{var lResultado=$.evalJSON($("#hidCliente_Suitability_Resultado").val());if(lResultado&&lResultado.Resultado)
{document.location="../Extras/Resultado_"+lResultado.Resultado+".pdf";}}
function GradIntra_Clientes_Suitability_EnviarPorEmail()
{GradIntra_ExibirMensagem("A","Não Implementado...");}
function GradIntra_Clientes_EfetivarRenovacao()
{var lDados={Acao:"EfetivarRenovacao",CPF:gGradIntra_Cadastro_ItemSendoEditado.CPF};GradIntra_CarregarJsonVerificandoErro("Clientes/Formularios/Acoes/EfetivarRenovacao.aspx",lDados,GradIntra_Clientes_EfetivarRenovacao_CallBack);}
function GradIntra_Clientes_EfetivarRenovacao_CallBack(pResposta)
{}
function GradIntra_Clientes_SalvarContratos(pDivDeFormulario)
{if($("[name^='chkClientes_Contratos_']:checked").length==0)
{alert("É necessário selecionar um contrato!");return false;}
var lDados={Acao:"Salvar",ParentId:$("#txtClientes_Contratos_ParentId").val(),Contratos:""};for(var i=0;i<$("[name^='chkClientes_Contratos_']:checked").length;i++)
lDados.Contratos+=$("[name^='chkClientes_Contratos_']:checked")[i].value+",";GradIntra_CarregarJsonVerificandoErro("Clientes/Formularios/Dados/Contratos.aspx",lDados,function(){GradIntra_ExibirMensagem("A","Dados salvos com sucesso.",true);});}﻿
function GradIntra_Risco_CarregarParametrosDaRegra()
{var lDados={Acao:"BuscarParametrosDaRegra",Id:$("#cboPerfilDeRisco_Regras_Regra").val()};$("#pnlFormulario_Campos_Regras p.Parametro").remove();if(lDados.Id!="")
{GradIntra_CarregarJsonVerificandoErro("Risco/Formularios/Dados/Regras.aspx",lDados,GradIntra_Risco_CarregarParametrosDaRegra_CallBack);}}
function GradIntra_Risco_CarregarParametrosDaRegra_CallBack(pResposta)
{var lRegra=pResposta.ObjetoDeRetorno;$(lRegra.Parametros).each(function()
{var lParagrafo="<p class='Parametro'>"
+"<label for='txtRisco_Regra_Parametro_"+this.Id+"'>"+this.Nome+":</label>"
+"<input  id='txtRisco_Regra_Parametro_"+this.Id+"' type='text'  IdParametro='"+this.Id+"' class='"+this.Validacoes+"' />"
+"</p>";lParagrafo=$("#pnlFormulario_Campos_Regras p.BotoesSubmit").before(lParagrafo).prev("p");lParagrafo.validationEngine({showTriangle:false});HabilitarMascaraNumerica(lParagrafo.find("input.Mascara_Data"),"99/99/9999");});$("#pnlFormulario_Campos_Regras").find("input.ProibirLetras").bind("keydown",function(event){Validacao_SomenteNumeros_OnKeyDown(event)});}
function GradIntra_Risco_SalvarRegra()
{}﻿
var gGradIntra_Seguranca_TipoDeObjetoDeSegurancaAtual=CONST_SEGURANCA_TIPODEOBJETO_USUARIO;function GradIntra_Seguranca_ReverterTipoDeObjetoDeSegurancaAtual(pTipoDeObjeto,pRecarregarConteudo)
{gGradIntra_Seguranca_TipoDeObjetoDeSegurancaAtual=pTipoDeObjeto;if(pRecarregarConteudo)
$("#pnlSeguranca_Formularios_Dados_DadosCompletos").removeClass(CONST_CLASS_CONTEUDOCARREGADO);$("#lstItemMenu_Seguranca li.Tipo_U, #lstItemMenu_Seguranca li.Tipo_G, #lstItemMenu_Seguranca li.Tipo_P").hide();$("#lstItemMenu_Seguranca li.Tipo_"+gGradIntra_Seguranca_TipoDeObjetoDeSegurancaAtual.charAt(0)).show();}
function GradIntra_Seguranca_SalvarDadosCompletos()
{var lDiv=$("#pnlSeguranca_Formularios_Dados_DadosCompletos");var lUrl="Seguranca/Formularios/Dados/DadosCompletos_"+gGradIntra_Seguranca_TipoDeObjetoDeSegurancaAtual+".aspx";if(gGradIntra_Cadastro_ItemSendoIncluido!=null)
{GradIntra_Cadastro_SalvarFormulario(lDiv,lUrl,"Cadastrar",GradIntra_Clientes_GuardarObjetoDeClienteInstanciado,GradIntra_Clientes_SalvarDadosCompletosDoCliente_CallBack);}
else
{GradIntra_Cadastro_SalvarFormulario(lDiv,lUrl,"Atualizar",null,null);}
return false;}
function GradIntra_Seguranca_ExcluirItem()
{var lUrl="Seguranca/Formularios/Dados/DadosCompletos_"+gGradIntra_Seguranca_TipoDeObjetoDeSegurancaAtual+".aspx";var lDados={Acao:'Excluir',Id:gGradIntra_Cadastro_ItemSendoEditado.Id};GradIntra_CarregarJsonVerificandoErro(lUrl,lDados,GradIntra_Seguranca_ExcluirItem_CallBack);}
function GradIntra_Seguranca_ExcluirItem_CallBack(pResposta)
{GradIntra_ExibirMensagem('I',pResposta.Mensagem);GradIntra_ExcluirItemDaListaDeItensSelecionados($('#lstItensSelecionados_Seguranca li.Expandida'));GradIntra_Navegacao_ExpandirDadosDoPrimeiroItemSelecionado();}﻿
function GradIntra_Monitoramento_ExcluirOrdensStartStopSelecionadas(pListaDeOrdens)
{var lDados={Acao:"ExcluirOrdens",Ids:pListaDeOrdens};GradIntra_CarregarJsonVerificandoErro("Monitoramento/ResultadoOrdensStop.aspx",lDados,GradIntra_Monitoramento_ExcluirOrdensStartStopSelecionadas_Callback);return false;}
function GradIntra_Monitoramento_ExcluirOrdensStartStopSelecionadas_Callback(pResposta)
{var linhasSelecionadas=$("#chkMonitoramento_ResultadoOrdens_SelecionarTodos").closest("table").find("tbody tr input[type='checkbox']:checked").closest("tr");linhasSelecionadas.find("#tdStatus").html("Cancelado");linhasSelecionadas.find("td:gt(0)").effect("highlight",{},2700);linhasSelecionadas.find("input[type='checkbox']").attr("checked",false);linhasSelecionadas.find("label").removeClass("checked");GradIntra_ExibirMensagem("I",pResposta.Mensagem);}
function GradIntra_Monitoramento_ExcluirOrdensSelecionadas(pListaDeOrdens)
{var lDados={Acao:"ExcluirOrdens",Ids:pListaDeOrdens};GradIntra_CarregarJsonVerificandoErro("Monitoramento/ResultadoOrdens.aspx",lDados,GradIntra_Monitoramento_ExcluirOrdensSelecionadas_Callback);return false;}
function GradIntra_Monitoramento_ExcluirOrdensSelecionadas_Callback(pResposta)
{var linhasSelecionadas=$("#chkBusca_SelecionarTodosResultados").closest("table").find("tbody tr input[type='checkbox']:checked").closest("tr");linhasSelecionadas.find("#tdStatus").html("Cancelada");linhasSelecionadas.find("td:gt(0)").effect("highlight",{},2700);linhasSelecionadas.find("input[type='checkbox']").attr("checked",false);linhasSelecionadas.find("label").removeClass("checked");GradIntra_ExibirMensagem("I",pResposta.Mensagem);}﻿
var gGradIntra_Sistema_TipoDeObjetoAtual="";function GradIntra_Sistema_ExibirConteudo()
{if(gGradIntra_Navegacao_SubSistemaAtual==CONST_SUBSISTEMA_VARIAVEIS)
{GradIntra_CarregarHtmlVerificandoErro("Sistema/VariaveisDoSistema.aspx",null,$("#pnlSistema_VariaveisDoSistema"),GradIntra_Sistema_ExibirConteudo_CallBack);}else if(gGradIntra_Navegacao_SubSistemaAtual==CONST_SUBSISTEMA_PESSOASVINCULADAS)
{GradIntra_CarregarHtmlVerificandoErro("Sistema/PessoasVinculadas.aspx",null,$("#pnlSistema_PessoasVinculadas"),GradIntra_Sistema_ExibirConteudo_CallBack,{CustomInputs:["input[type='checkbox']"]});}
else
{gGradIntra_Sistema_TipoDeObjetoAtual=$("#cboBusca_Sistema_ObjetosDoSistema").val();if(gGradIntra_Sistema_TipoDeObjetoAtual!="")
{var lDados={Acao:"CarregarHtmlComDados",Tipo:gGradIntra_Sistema_TipoDeObjetoAtual};$("#pnlSistema_ObjetosDoSistema").parent().show();GradIntra_Navegacao_ExibirFormulario("ObjetosDoSistema.aspx",GradIntra_Sistema_ExibirConteudo_CallBack,lDados);}
else
{GradIntra_ExibirMensagem("A","Favor selecionar um tipo de objeto",true);}}}
function GradIntra_Sistema_ExibirConteudo_CallBack()
{if(gGradIntra_Navegacao_SubSistemaAtual==CONST_SUBSISTEMA_VARIAVEIS)
{$("#pnlSistema_VariaveisDoSistema").show();$("#pnlSistema_ObjetosDoSistema").hide();$("#pnlSistema_PessoasVinculadas").hide();}else if(gGradIntra_Navegacao_SubSistemaAtual==CONST_SUBSISTEMA_PESSOASVINCULADAS)
{$("#pnlSistema_VariaveisDoSistema").hide();$("#pnlSistema_ObjetosDoSistema").hide();$("#pnlSistema_PessoasVinculadas").show();}
else
{$("#pnlSistema_VariaveisDoSistema").hide();$("#pnlSistema_PessoasVinculadas").hide();$("#pnlSistema_ObjetosDoSistema").removeClass(CONST_CLASS_CONTEUDOCARREGADO).find("p[class!='BotoesSubmit']").hide().parent().find("p[class='Form_"+gGradIntra_Sistema_TipoDeObjetoAtual+"']").show();}}
function GradIntra_Sistema_UploadDeArquivo_CallBack(pResposta){GradIntra_ExibirMensagem("I",pResposta.Mensagem);var lUrl="\'Sistema/ObjetosDoSistema.aspx\'";$("#tblObjetosdoSistema_ListaDeObjetos tbody").append("<tr rel=\""+pResposta.ObjetoDeRetorno.Id+"\">"
+"    <td>"+pResposta.ObjetoDeRetorno.Descricao+"</td>"
+"    <td>"
+"        <button class=\"IconButton Excluir\" title=\"Excluir objeto\" onclick=\"return btnSistema_ObjetosDoSistema_Excluir_Click("+lUrl+", this)\" style=\"margin-top:2px;margin-bottom:2px\"><span>Excluir</span></button>"
+"    </td>"
+"</tr>").find("tr.NenumItem").hide();GradIntra_AtivarTooltips($("#tblObjetosdoSistema_ListaDeObjetos tbody tr:last-child"));}
function GradIntra_Sistema_IncluirObjetoDeSistema()
{if(gGradIntra_Sistema_TipoDeObjetoAtual=="Contratos")
{var lUrl="Sistema/ObjetosDoSistema.aspx?Acao=ReceberArquivo";lUrl+="&Termo="+$("#txtObjetosDoSistema_Contratos_Termo").val();lUrl+="&Tipo="+$("#cboObjetosDoSistema_Contratos_Tipo").val();$.ajaxFileUpload({url:lUrl,secureuri:false,fileElementId:"txtObjetosDoSistema_Contratos_Arquivo",dataType:"json",success:GradIntra_Sistema_UploadDeArquivo_CallBack,error:function(data,status,e)
{alert(e);}});}
else
{var lDados={Acao:"Incluir",Tipo:gGradIntra_Sistema_TipoDeObjetoAtual,Id:""};if(gGradIntra_Sistema_TipoDeObjetoAtual=="AtividadesIlicitas")
{lDados.Id=$("#cboObjetosDoSistema_AtividadesIlicitas_Atividade").val();lDados.Descricao=$("#cboObjetosDoSistema_AtividadesIlicitas_Atividade option:selected").html();}
if(gGradIntra_Sistema_TipoDeObjetoAtual=="PaisesEmListaNegra")
{lDados.Id=$("#cboObjetosDoSistema_PaisesEmListaNegra_Pais").val();lDados.Descricao=$("#cboObjetosDoSistema_PaisesEmListaNegra_Pais option:selected").html();}
if(gGradIntra_Sistema_TipoDeObjetoAtual=="TiposDePendenciaCadastral")
{lDados.Id="0";lDados.Descricao=$("#txtObjetosDoSistema_TiposDePendenciaCadastral_Descricao").val();}
if(lDados.Id!="")
{var lRowItemExistente=$("#tblObjetosdoSistema_ListaDeObjetos tbody tr[rel='"+lDados.Id+"']")
if(lRowItemExistente.length==0)
{GradIntra_CarregarJsonVerificandoErro("Sistema/ObjetosDoSistema.aspx",lDados,GradIntra_Sistema_IncluirObjetoDeSistema_CallBack);}
else
{GradIntra_ExibirMensagem("I","Este objeto já está na lista.",true);}}
else
{GradIntra_ExibirMensagem("A","Favor selecionar um item para adicionar",true);}}}
function GradIntra_Sistema_IncluirObjetoDeSistema_CallBack(pResposta)
{GradIntra_ExibirMensagem("I",pResposta.Mensagem);var lUrl="\'Sistema/ObjetosDoSistema.aspx\'";$("#tblObjetosdoSistema_ListaDeObjetos tbody").append("<tr rel=\""+pResposta.ObjetoDeRetorno.Id+"\">"
+"    <td>"+pResposta.ObjetoDeRetorno.Descricao+"</td>"
+"    <td>"
+"        <button class=\"IconButton Excluir\" title=\"Excluir objeto\" onclick=\"return btnSistema_ObjetosDoSistema_Excluir_Click("+lUrl+", this)\" style=\"margin-top:2px;margin-bottom:2px\"><span>Excluir</span></button>"
+"    </td>"
+"</tr>").find("tr.NenumItem").hide();GradIntra_AtivarTooltips($("#tblObjetosdoSistema_ListaDeObjetos tbody tr:last-child"));}
function GradIntra_Sistema_ExcluirObjetoDeSistema(pUrl,pSender){if(confirm("Tem certeza que deseja excluir este item?")){gGradIntra_Sistema_TipoDeObjetoAtual=$("#cboBusca_Sistema_ObjetosDoSistema").val();var lTR=$(pSender).closest("tr");var lTBody=lTR.closest("tbody");if((lTR.attr("rel")+"")!=""){var lDados=new Object();lDados.Id=lTR.attr("rel");lDados.Acao="Excluir";lDados.Tipo=gGradIntra_Sistema_TipoDeObjetoAtual;GradIntra_CarregarJsonVerificandoErro(pUrl,lDados,function(pResposta){GradIntra_Sistema_ExcluirObjetoDeSistema_CallBack(pResposta,lTR);});}
if(lTBody.children("tr").length==2){lTBody.find("tr.Nenhuma").show();}}
return false;}
function GradIntra_Sistema_ExcluirObjetoDeSistema_CallBack(pResposta,pTR){GradIntra_ExibirMensagem("I",pResposta.Mensagem);pTR.remove();}
function GradIntra_Sistema_SalvarVariaveis()
{var lDados={Acao:"SalvarVariaveis",SalvarVariavel:$("#txtSistema_Variaveis_PeriodicidadeRenovacaoCadastral").val(),Id:$("#hidSistema_Variaveis_PeriodicidadeRenovacaoCadastral_Id").val()};GradIntra_CarregarJsonVerificandoErro("Sistema/VariaveisDoSistema.aspx",lDados,function(){GradIntra_ExibirMensagem("A","Variável alterada com sucesso.",true);});}
function GradIntra_Sistema_SalvarPessoasVinculadas(pDivDeFormulario)
{if(pDivDeFormulario.validationEngine({returnIsValid:true}))
{var lDados={Acao:"SalvarPessoasVinculadas",CodigoCliente:$("#txtPessoasVinculadas_CodigoCliente").val(),Nome:$("#txtPessoasVinculadas_Nome").val(),CPFCNPJ:$("#txtPessoasVinculadas_CPFCNPJ").val(),CodigoPessoaVinculadaResponsavel:$("#txtPessoasVinculadas_CodigoPessoaVinculada").val(),FlagAtivo:$("#txtPessoasVinculadas_Ativo").is(":checked"),Id:$("#hidSistema_PessoasVinculadas_Id").val()};GradIntra_CarregarJsonVerificandoErro("Sistema/PessoasVinculadas.aspx",lDados,GradIntra_Sistema_IncluirPessoasVinculadas_CallBack);}}
function GradIntra_Sistema_BuscarClientePessoasVinculadas()
{var spanResposta=$("#txtPessoasVinculadas_Nome_Cliente");if(!isNaN(parseInt($("#txtPessoasVinculadas_CodigoCliente").val(),10)))
{var lDados={Acao:"BuscaCliente",CodigoCliente:$("#txtPessoasVinculadas_CodigoCliente").val()};GradIntra_CarregarJsonVerificandoErro("Sistema/PessoasVinculadas.aspx",lDados,function(pResposta,spanResposta){GradIntra_Sistema_BuscarClientePessoasVinculadas_CallBack(pResposta,spanResposta);});}}
function GradIntra_Sistema_BuscarClientePessoasVinculadas_CallBack(pResposta,spanResposta)
{$("#txtPessoasVinculadas_Nome_Cliente").html((pResposta.ObjetoDeRetorno==null)?pResposta.Mensagem:pResposta.ObjetoDeRetorno.NomeCliente);}
function GradIntra_Sistema_ExcluirPessoasVinculadas(pUrl,pSender){if(confirm("Tem certeza que deseja excluir esta pessoa?")){var lTR=$(pSender).closest("tr");var lTBody=lTR.closest("tbody");if((lTR.attr("rel")+"")!=""){var lDados=new Object();lDados.Id=lTR.attr("rel");lDados.Acao="Excluir";GradIntra_CarregarJsonVerificandoErro(pUrl,lDados,function(pResposta){GradIntra_Sistema_ExcluirPessoasVinculadas_CallBack(pResposta,lTR);});}
if(lTBody.children("tr").length==2){lTBody.find("tr.Nenhuma").show();}}
return false;}
function GradIntra_Sistema_ExcluirPessoasVinculadas_CallBack(pResposta,pTR)
{GradIntra_ExibirMensagem("I",pResposta.Mensagem);if(pResposta.ObjetoDeRetorno==null)
pTR.remove();else
{if(!pResposta.ObjetoDeRetorno)
pTR.remove();}}
function GradIntra_Sistema_IncluirPessoasVinculadas_CallBack(pResposta)
{GradIntra_ExibirMensagem("I",pResposta.Mensagem);var lUrl="\'Sistema/PessoasVinculadas.aspx\'";$("#tblPessoaVinculadas_ListaDePessoasVinculadas tbody").append("<tr rel=\""+pResposta.ObjetoDeRetorno.CodigoPessoaVinculada+"\">"
+"    <td>"+pResposta.ObjetoDeRetorno.CodigoPessoaVinculada+"</td>"
+"    <td>"+pResposta.ObjetoDeRetorno.CPFCNPJ+"</td>"
+"    <td>"+pResposta.ObjetoDeRetorno.Nome+"</td>"
+"    <td>"+pResposta.ObjetoDeRetorno.CodigoPessoaVinculadaResponsavel+"</td>"
+"    <td>"+pResposta.ObjetoDeRetorno.CodigoCliente+"</td>"
+"    <td>"
+"        <button class=\"IconButton Excluir\" title=\"Excluir objeto\" onclick=\"return btnSistema_PessoasVinculadas_Excluir_Click("+lUrl+", this)\" style=\"margin-top:2px;margin-bottom:2px\"><span>Excluir</span></button>"
+"    </td>"
+"</tr>").find("tr.NenumItem").hide();GradIntra_AtivarTooltips($("#tblPessoaVinculadas_ListaDePessoasVinculadas tbody tr:last-child"));}﻿
function PageLoad()
{Preferencias_IniciarPreferencias();GradIntra_Navegacao_IrParaSubSistema(gPreferenciasDoUsuario.UltimoSistema,gPreferenciasDoUsuario.UltimoSubSistema);GradIntra_AtivarTooltips();$(window).bind("resize",PageResize);}
function PageResize()
{if(gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_CLIENTES||gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_SEGURANCA||gGradIntra_Navegacao_SistemaAtual==CONST_SISTEMA_RISCO)
{if($("#pnlBusca_"+gGradIntra_Navegacao_SistemaAtual+"_Resultados").is(":visible"))
{if($("#gbox_tblBusca_"+gGradIntra_Navegacao_SistemaAtual+"_Resultados").is(":visible"))
{var lWidth=$("#pnlBusca_"+gGradIntra_Navegacao_SistemaAtual+"_Resultados").width()-500;if(lWidth>510)
{$("#tblBusca_"+gGradIntra_Navegacao_SistemaAtual+"_Resultados").setGridWidth(lWidth);}}}}}
function lnkMenuPrincipal_Click(pSender)
{GradIntra_Navegacao_IrParaSistema($(pSender).attr("rel"),true);return false;}
function lnkMenuSecundario_Click(pSender,pEventArgs)
{GradIntra_Navegacao_IrParaSubSistema(gGradIntra_Navegacao_SistemaAtual,$(pSender).attr("rel"));return false;}
function lnkSubMenu_Sistema_Objetos_Click(pSender)
{Sistema_ExibirObjetosDoSistema();return false;}
function lnkSubMenu_Sistema_Variaveis_Click(pSender)
{Sistema_ExibirVariaveisDoSistema();return false;}
function lnlMensagemAdicional_Fechar_Click(pSender)
{GradIntra_OcultarMensagemAdicional();return false;}
function btnBusca_Click()
{switch(gGradIntra_Navegacao_SistemaAtual)
{case CONST_SISTEMA_CLIENTES:var lDados=GradIntra_Clientes_InstanciarParametrosDeBusca();GradIntra_Busca_BuscarItensParaSelecao(lDados,$("#pnlBusca_Clientes_Form"),"Buscas/Clientes.aspx");break;case CONST_SISTEMA_SEGURANCA:GradIntra_Busca_BuscarItensParaSelecao(null,$("#pnlBusca_Seguranca_Form"),"Buscas/Seguranca.aspx");break;case CONST_SISTEMA_PAPEIS:GradIntra_Busca_BuscarItensParaSelecao(null,$("#pnlBusca_Papeis_Form"),"Buscas/Papeis.aspx");break;case CONST_SISTEMA_SISTEMA:GradIntra_Sistema_ExibirConteudo();break;case CONST_SISTEMA_RISCO:GradIntra_Busca_BuscarItensParaSelecao(null,$("#pnlBusca_Risco_Form"),"Buscas/Risco.aspx");break;default:GradIntra_ExibirMensagem("E","Sem função de busca para o sistema "+gGradIntra_Navegacao_SistemaAtual);break;}
return false;}
function btnResultadoBusca_ExpandirPainel_Click(pSender,pIdDoGrid)
{pSender=$(pSender);GradIntra_Navegacao_ExpandirTabelaDeBusca(pSender.closest("div.Busca_Resultados"),pIdDoGrid);return false;}
function lstItensSelecionados_btnCancelarNovo_OnClick(pSender,pTipoDeItem)
{if(confirm("Tem certeza que deseja cancelar o cadastro do novo "+pTipoDeItem+"?"))
{GradIntra_Navegacao_OcultarFormularioDeNovoItem();}
return false;}
function lstItensSelecionados_btnFechar_Click(pSender)
{GradIntra_ExcluirItemDaListaDeItensSelecionados($(pSender).closest("li"));return false;}
function lstClientesSelecionados_H3_OnClick(pSender)
{var lLI=$(pSender).parent();if(!lLI.hasClass("Expandida"))
{GradIntra_Navegacao_ExpandirItemSelecionado(lLI);}
return false;}
function lstItensSelecionados_LI_MouseEnter(pSender)
{var li=$(pSender.target).closest("li."+CONST_CLASS_ITEM_ITEMDINAMICO);if(!li.hasClass(CONST_CLASS_ITEM_EXPANDIDO))
{li.css({opacity:1});}}
function lstItensSelecionados_LI_MouseLeave(pSender)
{var li=$(pSender.target).closest("li."+CONST_CLASS_ITEM_ITEMDINAMICO);if(!li.hasClass(CONST_CLASS_ITEM_EXPANDIDO))
{li.css({opacity:0.5});}}
function lstMenuCliente_A_OnClick(pSender)
{if($("div."+CONST_CLASS_CARREGANDOCONTEUDO).length>0)return false;pSender=$(pSender);var lURL=pSender.attr("href");GradIntra_Navegacao_ExibirFormulario(lURL);return false;}
function btnSalvar_Clientes_DadosCompletos_Click(pSender)
{GradIntra_Clientes_SalvarDadosCompletosDoCliente();return false;}
function btnSalvar_Clientes_Rendimentos_Click(pSender)
{GradIntra_Clientes_SalvarItemFilhoDoCliente("RendimentosSituacaoFinanceira");return false;}
function btnSalvar_Clientes_InformacoesPatrimoniais_Click(pSender)
{GradIntra_Clientes_SalvarItemFilhoDoCliente("InformacoesPatrimoniais");return false;}
function btnClientes_InformacaoBancaria_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Conta",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/InformacoesBancarias.aspx");return false;}
function btnClientes_Telefones_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Telefone",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/Telefones.aspx");return false;}
function btnClientes_Diretores_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Diretor",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/Diretores.aspx");return false;}
function btnClientes_RepresentantesParaNaoResidente_Salvar_Click(pSender){GradIntra_Cadastro_SalvarItemFilho("RepresentanteParaNaoResidente",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/RepresentantesParaNaoResidente.aspx");return false;}
function btnClientes_EmpresasColigadas_Salvar_Click(pSender){GradIntra_Cadastro_SalvarItemFilho("EmpresaColigada",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/EmpresasColigadas.aspx");return false;}
function btnClientes_Enderecos_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Endereco",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/Enderecos.aspx");return false;}
function btnClientes_Procuradores_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Procurador",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/Procuradores.aspx");return false;}
function btnClientes_Representantes_Salvar_Click(pSender){GradIntra_Cadastro_SalvarItemFilho("Representante",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/RepresentantesLegais.aspx");return false;}
function btnAcoes_Pendenciacadastral_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("PendenciaCadastral",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Acoes/VerPendencias.aspx");return false;}
function btnClientes_PessoasAutorizadas_Salvar_Click(pSender){GradIntra_Cadastro_SalvarItemFilho("Emitente",$(pSender).closest("div.pnlFormulario_Campos"),"Clientes/Formularios/Dados/PessoasAutorizadas.aspx");return false;}
function btnClientes_Acoes_SincronizarComSinacor_Click(pSender)
{if(confirm("Tem certeza que deseja iniciar a sincronização?"))
{GradIntra_Clientes_IniciarSincronizacaoComSinacor();}
return false;}
function cboClientes_MigracaoEntreAssessores_AssessorDe_Change(pSender)
{if($("#pnlClientes_Assessores").is(":visible"))
{$("#pnlClientes_MigracaoEntreAssessores").removeClass(CONST_CLASS_CONTEUDOCARREGADO).html("").parent().hide();}}
function btnClientes_Assessores_BuscarClientesDoAssessor_Click(pSender)
{var lValor=$("#cboClientes_MigracaoEntreAssessores_AssessorDe").val();if(lValor!="")
{GradIntra_Busca_BuscarItensParaListagemSimples($("#pnlClientes_Assessores"),$("#pnlClientes_MigracaoEntreAssessores"),"Clientes/Formularios/MigracaoEntreAssessores.aspx",{CamposObrigatorios:null});}
else
{GradIntra_ExibirMensagem("A","Favor selecionar um assessor",true);}
return false;}
function trClientes_MigracaoEntreAssessores_Click(pSender)
{pSender=$(pSender);var lCheck=pSender.find("td:first-child input[type='checkbox']");if(lCheck.is(":checked"))
{lCheck.attr("checked",null);lCheck.next("label").removeClass("checked");}
else
{lCheck.attr("checked","checked");lCheck.next("label").addClass("checked");}
GradIntra_Clientes_MigracaoEntreAssessores_VerificarMarcados();}
function cboClientes_MigracaoEntreAssessores_AssessorPara_Change(pSender)
{pSender=$(pSender);var lValor=pSender.val();var lBotao=pSender.next("button");if(lValor=="")
{lBotao.attr("disabled","disabled");}
else if(lValor==$("#cboClientes_MigracaoEntreAssessores_AssessorDe").val())
{lBotao.attr("disabled","disabled");GradIntra_ExibirMensagem("A","O acessor de destino é o mesmo de origem, favor escolher outro.",true);}
else
{lBotao.attr("disabled",null);}}
function btnClientes_MigracaoEntreAssessores_RealizarMigracao_Click(pSender)
{GradIntra_Clientes_MigracaoEntreAssessores_RealizarMigracao();return false;}
function btnCliente_Suitability_Enviar_Click(pSender)
{GradIntra_Clientes_Suitability_EnviarRespostas();return false;}
function btnClientes_Suitability_Refazer_Click(pSender)
{GradIntra_Clientes_Suitability_RefazerTeste();return false;}
function btnClientes_Suitability_DownloadPDF_Click(pSender)
{GradIntra_Clientes_Suitability_DownloadPDF();return false;}
function btnClientes_Suitability_EnviarPorEmail_Click(pSender)
{GradIntra_Clientes_Suitability_EnviarPorEmail();return false;}
function btnClientes_EfetivarRenovacao_Click(pSender)
{GradIntra_Clientes_EfetivarRenovacao();return false;}
function cboRelatorios_TipoDeRelatorio_Change(pSender)
{pSender=$(pSender);var lDivFormulario=pSender.closest(".Busca_Formulario");var lValor=pSender.val();$(".pnlRelatorio").hide();GradIntra_Relatorio_OcultarExibirFiltros(lDivFormulario,lValor);}
function Clientes_Relatorios_ConfiguraCamposObrigatorios(pRelatorio)
{var lArrReturn;switch(pRelatorio)
{case"R001":lArrReturn=["txtClientes_FiltroRelatorio_DataInicial","txtClientes_FiltroRelatorio_DataFinal","txtClientes_FiltroRelatorio_Assessor"];break;}
return lArrReturn;}
function btnClientes_Relatorios_FiltrarRelatorio_Click(pSender)
{var lRelatorio=$("#cboClientes_FiltroRelatorio_Relatorio").val();if(lRelatorio!="")
{var lUrl="Clientes/Relatorios/"+lRelatorio+".aspx";GradIntra_Busca_BuscarItensParaListagemSimples($("#pnlClientes_FiltroRelatorio"),$("#pnlClientes_Relatorios_Resultados"),lUrl,{CamposObrigatorios:Clientes_Relatorios_ConfiguraCamposObrigatorios(lRelatorio)});}
else
{GradIntra_ExibirMensagem("A","Favor selecionar um relatório");}
return false;}
function btnSalvar_Seguranca_DadosCompletos_Click()
{GradIntra_Seguranca_SalvarDadosCompletos();return false;}
function btnBusca_Monitoramento_Ordens_Click(pSender)
{GradIntra_Busca_BuscarItensParaListagemSimples($("#pnlBusca_Monitoramento_Ordens_Form"),$("#pnlMonitoramento_ListaDeResultados"),"Monitoramento/ResultadoOrdens.aspx",{CamposObrigatorios:null});return false;}
function btnBusca_Monitoramento_OrdensStop_Click(pSender)
{GradIntra_Busca_BuscarItensParaListagemSimples($("#pnlBusca_Monitoramento_OrdensStop_Form"),$("#pnlMonitoramento_ListaDeResultados"),"Monitoramento/ResultadoOrdensStop.aspx",{CamposObrigatorios:["txtBusca_Monitoramento_OrdensStop_Data"]});return false;}
function chkMonitoramento_ResultadoOrdensStop_SelecionarTodosResultados_OnClick(pSender)
{var lTbody=$(pSender).closest("table").find("tbody");if(pSender.checked){lTbody.find("tr input[type='checkbox']").attr("checked",true);lTbody.find("tr div.custom-checkbox label").addClass("checked");}
else{lTbody.find("tr input[type='checkbox']").attr("checked",false);lTbody.find("tr div.custom-checkbox label").removeClass("checked");}}
function btnMonitoramento_ExcluirOrdensStartStopSelecionados_Click(pSender)
{if(confirm("Você realmente deseja cancelar as ordens selecionadas?"))
{var lChecados=$(pSender).closest("table").find("tbody tr input[type='checkbox']:checked");var lIds="";lChecados.each(function()
{lIds+=$(this).attr("rel")+",";});GradIntra_Monitoramento_ExcluirOrdensStartStopSelecionadas(lIds);}
return false;}
function chkBusca_SelecionarTodosResultados_OnClick(pSender)
{var lTbody=$(pSender).closest("table").find("tbody");if(pSender.checked){lTbody.find("tr input[type='checkbox']").attr("checked",true);lTbody.find("tr div.custom-checkbox label").addClass("checked");}
else{lTbody.find("tr input[type='checkbox']").attr("checked",false);lTbody.find("tr div.custom-checkbox label").removeClass("checked");}}
function btnMonitoramento_ExcluirOrdensSelecionadas_Click(pSender)
{if(confirm("Você realmente deseja cancelar as ordens selecionadas?"))
{var lChecados=$(pSender).closest("table").find("tbody tr input[type='checkbox']:checked");var lIds="";lChecados.each(function()
{lIds+=$(this).attr("rel")+",";});GradIntra_Monitoramento_ExcluirOrdensSelecionadas(lIds);}
return false;}
function btnSistema_Variaveis_Salvar_Click(pSender)
{GradIntra_Sistema_SalvarVariaveis();return false;}
function btnSistema_ObjetosDoSistema_Incluir_Click(pSender)
{GradIntra_Sistema_IncluirObjetoDeSistema();return false;}
function btnSistema_ObjetosDoSistema_Excluir_Click(pUrl,pSender)
{GradIntra_Sistema_ExcluirObjetoDeSistema(pUrl,pSender);return false;}
function btnSistema_PessoasVinculadas_Excluir_Click(pUrl,pSender)
{GradIntra_Sistema_ExcluirPessoasVinculadas(pUrl,pSender);return false;}
function btnSistema_PessoasVinculadas_Incluir_Click(pSender)
{GradIntra_Sistema_SalvarPessoasVinculadas($(pSender).closest("div.pnlFormulario_Campos"));return false;}
function btnSalvar_Papeis_DadosCompletos_Click(pSender)
{return false;}
function btnSistema_PessoasVinculadas_BuscarCliente_Click(pSender)
{GradIntra_Sistema_BuscarClientePessoasVinculadas();return false;}
function btn_imprimir_ficha_click()
{GradInfra_Relatorio_ImprimirFichaDuc_PF();return false;}
function lstMenuSeguranca_Excluir_OnClick(pSender)
{GradIntra_Seguranca_ExcluirItem()
return false;}
function btnSeguranca_Usuarios_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Usuarios",$(pSender).closest("div.pnlFormulario_Campos"),"Seguranca/Formularios/Dados/Usuarios.aspx");return false;}
function btnSeguranca_Grupos_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Grupos",$(pSender).closest("div.pnlFormulario_Campos"),"Seguranca/Formularios/Dados/Grupos.aspx");return false;}
function btnSeguranca_Permissoes_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Permissoes",$(pSender).closest("div.pnlFormulario_Campos"),"Seguranca/Formularios/Dados/Permissoes.aspx");return false;}
function btnSeguranca_Perfis_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Perfis",$(pSender).closest("div.pnlFormulario_Campos"),"Seguranca/Formularios/Dados/Perfis.aspx");return false;}
function btnClientes_Contratos_Salvar_Click(pSender)
{GradIntra_Clientes_SalvarContratos($(pSender).closest("div.pnlFormulario_Campos"));return false;}
function cboPerfilDeRisco_Regras_Regra_Change(pSender)
{GradIntra_Risco_CarregarParametrosDaRegra();}
function btnPerfilDeRisco_Regras_Salvar_Click(pSender)
{GradIntra_Cadastro_SalvarItemFilho("Regra",$(pSender).closest("div.pnlFormulario_Campos"),"Risco/Formularios/Dados/Regras.aspx");return false;}